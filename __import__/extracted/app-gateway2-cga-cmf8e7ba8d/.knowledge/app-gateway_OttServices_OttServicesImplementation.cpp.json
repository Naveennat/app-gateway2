{"is_source_file": true, "format": "C++", "description": "This file implements the OttServicesImplementation class, which provides functionality for permissions management, authentication metadata collection, and service configuration within the WPEFramework plugin. It handles interactions with external services such as permissions and authentication, and contains methods for initializing, deinitializing, and executing various service-related operations.", "external_files": ["OttServicesImplementation.h", "core/Enumerate.h", "UtilsLogging.h", "OttPermissionCache.h", "UtilsJsonrpcDirectLink.h"], "external_methods": ["Utils::GetThunderControllerClient", "OttPermissionCache::Instance", "PermissionsClient::EnumeratePermissions", "PermissionsClient::Endpoint"], "published": ["Configure", "Initialize", "Deinitialize", "Ping", "GetPermissions", "InvalidatePermissions", "CollectAuthMetadata", "UpdatePermissionsCache"], "classes": [{"name": "OttServicesImplementation", "description": "Class implementing OttServicesInterface, managing permissions, authentication, and configuration for OTT services."}], "methods": [{"name": "uint32_t Configure(PluginHost::IShell * shell)", "description": "Sets up the service with the provided shell, initializing internal state.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "string Initialize(PluginHost::IShell * service)", "description": "Loads configuration, creates permissions client, and prepares cache.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "void Deinitialize(PluginHost::IShell *)", "description": "Cleans up resources and resets internal state.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "Core::hresult Ping(const string & message,string & reply)", "description": "Responds with a pong message, used for health checks.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "Core::hresult GetPermissions(const string & appId,std::vector<string> & permissionsOut)", "description": "Retrieves permissions for a given app ID, either as a vector or JSON string.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "Core::hresult InvalidatePermissions(const string & appId)", "description": "Invalidates the permissions cache for the specified app ID.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "bool CollectAuthMetadata(std::string & bearerToken,std::string & deviceId,std::string & accountId,std::string & partnerId) const", "description": "Collects authentication tokens and related metadata via the AuthService.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "Core::hresult UpdatePermissionsCache(const string & appId,uint32_t & updatedCount)", "description": "Updates the permissions cache for a specific app ID based on current auth metadata and permissions fetched from external service.", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"name": "Core::hresult GetPermissions(const string & appId,string & permissionsJson)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class", "description": "unavailable"}, {"name": "OttServicesImplementation()", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class", "description": "unavailable"}], "calls": ["Utils::GetThunderControllerClient", "OttPermissionCache::Instance", "PermissionsClient::EnumeratePermissions", "PermissionsClient::Endpoint", "JsonObject::Invoke", "JsonObject::HasLabel", "JsonObject::operator[]", "JsonObject::Clear"], "search-terms": ["OttServicesImplementation", "PermissionsClient", "CollectAuthMetadata", "UpdatePermissionsCache", "PermissionsEndpoint", "AuthService", "JsonObject", "Permissions"], "state": 2, "file_id": 51, "knowledge_revision": 437, "git_revision": "2bdba5cf8c479e9a9dab6c131daae4d58f0bd734", "revision_history": [{"160": ""}, {"174": "0122b584310d777b8d07f9a9be695f2cb90c09dd"}, {"175": "0122b584310d777b8d07f9a9be695f2cb90c09dd"}, {"176": "0122b584310d777b8d07f9a9be695f2cb90c09dd"}, {"177": "0122b584310d777b8d07f9a9be695f2cb90c09dd"}, {"178": "0122b584310d777b8d07f9a9be695f2cb90c09dd"}, {"192": "c8e47b2a6d37c6d5c56d0ecafffe3d8cbec64b9e"}, {"242": "648fe4facac7e3617f078e1af2f5ab5734b54229"}, {"246": "b0e01aa51ae6843a5d01bbae74faf0038a2e4a91"}, {"254": "b0e01aa51ae6843a5d01bbae74faf0038a2e4a91"}, {"259": "b980f4e3e253a8299a669f5f0622cb22913a253d"}, {"295": "b980f4e3e253a8299a669f5f0622cb22913a253d"}, {"328": "a7a470609e5ec86bfb827285d49e4d69ba63ed5b"}, {"413": "ee01dfa922d65deb1655acc4f9ef7a881f6c3e05"}, {"433": "2bdba5cf8c479e9a9dab6c131daae4d58f0bd734"}, {"437": "2bdba5cf8c479e9a9dab6c131daae4d58f0bd734"}], "ctags": [{"_type": "tag", "name": "CollectAuthMetadata", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    bool OttServicesImplementation::CollectAuthMetadata(std::string& bearerToken,$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(std::string & bearerToken,std::string & deviceId,std::string & accountId,std::string & partnerId) const", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "Configure", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    uint32_t OttServicesImplementation::Configure(PluginHost::IShell* shell) {$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(PluginHost::IShell * shell)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "Deinitialize", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    void OttServicesImplementation::Deinitialize(PluginHost::IShell* \\/*service*\\/) {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(PluginHost::IShell *)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "GetPermissions", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    Core::hresult OttServicesImplementation::GetPermissions(const string& appId, std::vector<str/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const string & appId,std::vector<string> & permissionsOut)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "GetPermissions", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    Core::hresult OttServicesImplementation::GetPermissions(const string& appId, string& permiss/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const string & appId,string & permissionsJson)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "Initialize", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    string OttServicesImplementation::Initialize(PluginHost::IShell* service) {$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "(PluginHost::IShell * service)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "InvalidatePermissions", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    Core::hresult OttServicesImplementation::InvalidatePermissions(const string& appId) {$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const string & appId)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "OttServicesImplementation", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    OttServicesImplementation::OttServicesImplementation()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "Ping", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    Core::hresult OttServicesImplementation::Ping(const string& message, string& reply) {$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const string & message,string & reply)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^namespace Plugin {$/", "file": true, "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "UpdatePermissionsCache", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    Core::hresult OttServicesImplementation::UpdatePermissionsCache(const string& appId, uint32_/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const string & appId,uint32_t & updatedCount)", "scope": "WPEFramework::Plugin::OttServicesImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^namespace WPEFramework {$/", "file": true, "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "__anonef41e7940111", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^    namespace {$/", "file": true, "language": "C++", "kind": "namespace", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "kAuthServiceCallsign", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^        static constexpr const char* kAuthServiceCallsign = \"org.rdk.AuthService\";$/", "file": true, "language": "C++", "typeref": "typename:const char *", "kind": "variable", "scope": "WPEFramework::Plugin::__anonef41e7940111", "scopeKind": "namespace"}, {"_type": "tag", "name": "kDefaultPermsEndpoint", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/OttServices/OttServicesImplementation.cpp", "pattern": "/^        static constexpr const char* kDefaultPermsEndpoint = \"thor-permission.svc.thor.comcast.c/", "file": true, "language": "C++", "typeref": "typename:const char *", "kind": "variable", "scope": "WPEFramework::Plugin::__anonef41e7940111", "scopeKind": "namespace"}], "hash": "db47f1032fad08c274d71b93336526ec", "format-version": 4, "code-base-name": "app-gateway2", "filename": "app-gateway/OttServices/OttServicesImplementation.cpp", "fields": [{"name": "const char * kAuthServiceCallsign", "scope": "WPEFramework::Plugin::__anonef41e7940111", "scopeKind": "namespace", "description": "unavailable"}, {"name": "const char * kDefaultPermsEndpoint", "scope": "WPEFramework::Plugin::__anonef41e7940111", "scopeKind": "namespace", "description": "unavailable"}]}