{"is_source_file": true, "format": "C++ header file (.h)", "description": "This file defines the Store2 class, which implements gRPC communication with a secure storage service, providing methods to set, get, and delete key-value pairs, manage notification subscriptions, and handle configuration. It includes internal classes like Job for dispatching value change notifications. The class interacts with external services via gRPC stubs and manages authorization, system state checks, and configuration parameters.", "external_files": ["../Module.h", "secure_storage.grpc.pb.h", "<fstream>", "<grpcpp/create_channel.h>", "<interfaces/IStore2.h>", "<interfaces/IConfiguration.h>", "<interfaces/IAuthService.h>", "<libIBus.h>", "<sysMgr.h>"], "external_methods": ["grpc::CreateCustomChannel", "grpc::SslCredentials", "grpc::InsecureChannelCredentials", "Core::IWorkerPool::Instance().Submit", "Core::ProxyType<Core::IDispatch>::Create", "Core::IDispatch::Dispatch", "Core::CriticalSection", "Core::SafeSyncType", "TRACE", "getenv", "time", "std::getline", "std::find", "std::ifstream::ifstream"], "published": ["Exchange::IStore2", "Exchange::IConfiguration"], "classes": [{"name": "Store2", "description": "A class implementing the IStore2 and IConfiguration interfaces for gRPC-based secure storage. It manages key-value operations, notifications, authorization, and configuration."}, {"name": "Store2::Job", "description": "A helper class for dispatching value change notifications asynchronously."}], "methods": [{"name": "Store2()", "description": "Default constructor, initializes with environment variables URI and TOKEN.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "Store2(const string & uri,const string & token)", "description": "Constructor accepting explicit URI and token strings, initializes gRPC stub and opens connection.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "~Store2()", "description": "Destructor, releases the gRPC service stub.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "void Open()", "description": "Initializes gRPC channel and stub with appropriate credentials.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "bool IsTimeSynced() const", "description": "Checks if system time is synchronized, querying system manager if WITH_SYSMGR is defined.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "string GetToken() const", "description": "Retrieves current service access token via IAuthService plugin.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "string GetPartnerId() const", "description": "Reads partner ID from a predefined file.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "string GetAccountId() const", "description": "Reads account ID from a predefined file.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "string GetDeviceId() const", "description": "Reads device ID from a predefined file.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t Register(INotification * notification)", "description": "Registers a notification callback for value changes.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t Unregister(INotification * notification)", "description": "Unregisters a notification callback.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t SetValue(const ScopeType scope,const string & ns,const string & key,const string & value,const uint32_t ttl)", "description": "Sets a key-value pair in the secure storage with optional TTL.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t GetValue(const ScopeType scope,const string & ns,const string & key,string & value,uint32_t & ttl)", "description": "Retrieves a value and TTL for a given key.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t DeleteKey(const ScopeType scope,const string & ns,const string & key)", "description": "Deletes a specific key in the storage.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t DeleteNamespace(const ScopeType scope,const string & ns)", "description": "Deletes all keys within a namespace.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "uint32_t Configure(PluginHost::IShell * service)", "description": "Associates the Store2 instance with the service shell for configuration.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "void OnValueChanged(const ScopeType scope,const string & ns,const string & key,const string & value)", "description": "Invokes registered callbacks when a value change occurs.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "void OnError(const char * fn,const grpc::Status & status) const", "description": "Logs gRPC errors.", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"name": "void Dispatch()", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}, {"name": "Job(Store2 * parent,const ScopeType scope,const string & ns,const string & key,const string & value)", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}, {"name": "~Job()", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}], "calls": ["grpc::CreateCustomChannel", "grpc::SslCredentials", "grpc::InsecureChannelCredentials", "Core::IWorkerPool::Instance().Submit", "Core::ProxyType<Core::IDispatch>::Create", "Exchange::IAuthService::GetServiceAccessToken", "IARM_Bus_Init", "IARM_Bus_Connect", "IARM_Bus_SYSMgr_GetSystemStates_Param_t::state", "IARM_Bus_Call_with_IPCTimeout"], "search-terms": ["gRPC secure storage", "IStore2 implementation", "Token retrieval", "SetValue gRPC", "GetValue gRPC", "DeleteKey gRPC", "notifications callback", "configuration integration", "grpc stub class", "system state check", "IDispatch internal class"], "state": 2, "file_id": 69, "knowledge_revision": 447, "git_revision": "", "ctags": [{"_type": "tag", "name": "Configure", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            virtual uint32_t Configure(PluginHost::IShell* service) override$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(PluginHost::IShell * service)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "DeleteKey", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            uint32_t DeleteKey(const ScopeType scope, const string& ns, const string& key) overr/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const ScopeType scope,const string & ns,const string & key)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "DeleteNamespace", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            uint32_t DeleteNamespace(const ScopeType scope, const string& ns) override$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const ScopeType scope,const string & ns)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Dispatch", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                void Dispatch() override$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "GetAccountId", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            string GetAccountId() const$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "GetDeviceId", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            string GetDeviceId() const$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "GetPartnerId", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            string GetPartnerId() const$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "GetToken", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            string GetToken() const$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "GetValue", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            uint32_t GetValue(const ScopeType scope, const string& ns, const string& key, string/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const ScopeType scope,const string & ns,const string & key,string & value,uint32_t & ttl)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Grpc", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^    namespace Grpc {$/", "language": "C++", "kind": "namespace", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "IsTimeSynced", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            bool IsTimeSynced() const$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "() const", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Job", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                Job(Store2* parent, const ScopeType scope, const string& ns, const string& key, /", "language": "C++", "kind": "function", "signature": "(Store2 * parent,const ScopeType scope,const string & ns,const string & key,const string & value)", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "Job", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            class Job : public Core::IDispatch {$/", "language": "C++", "kind": "class", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "OnError", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            void OnError(const char* fn, const grpc::Status& status) const$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const char * fn,const grpc::Status & status) const", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "OnValueChanged", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            void OnValueChanged(const ScopeType scope, const string& ns, const string& key, cons/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const ScopeType scope,const string & ns,const string & key,const string & value)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Open", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            void Open()$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^namespace Plugin {$/", "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "Register", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            uint32_t Register(INotification* notification) override$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(INotification * notification)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "SetValue", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            uint32_t SetValue(const ScopeType scope, const string& ns, const string& key, const /", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const ScopeType scope,const string & ns,const string & key,const string & value,const uint32_t ttl)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Store2", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            Store2()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Store2", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            Store2(const string& uri, const string& token)$/", "language": "C++", "kind": "function", "signature": "(const string & uri,const string & token)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "Store2", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^        class Store2 : public Exchange::IStore2, public Exchange::IConfiguration {$/", "language": "C++", "kind": "class", "scope": "WPEFramework::Plugin::Grpc", "scopeKind": "namespace"}, {"_type": "tag", "name": "Unregister", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            uint32_t Unregister(INotification* notification) override$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(INotification * notification)", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^namespace WPEFramework {$/", "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "_authorization", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            const bool _authorization;$/", "language": "C++", "typeref": "typename:const bool", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_clientLock", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            Core::CriticalSection _clientLock;$/", "language": "C++", "typeref": "typename:Core::CriticalSection", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_clients", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            std::list<INotification*> _clients;$/", "language": "C++", "typeref": "typename:std::list<INotification * >", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_key", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                const string _key;$/", "language": "C++", "typeref": "typename:const string", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "_ns", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                const string _ns;$/", "language": "C++", "typeref": "typename:const string", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "_parent", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                Store2* _parent;$/", "language": "C++", "typeref": "typename:Store2 *", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "_scope", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                const ScopeType _scope;$/", "language": "C++", "typeref": "typename:const ScopeType", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "_service", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            PluginHost::IShell* _service;$/", "language": "C++", "typeref": "typename:PluginHost::IShell *", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_stub", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            std::unique_ptr<::distp::gateway::secure_storage::v1::SecureStorageService::Stub> _s/", "language": "C++", "typeref": "typename:std::unique_ptr<::distp::gateway::secure_storage::v1::SecureStorageService::Stub>", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_token", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            const string _token;$/", "language": "C++", "typeref": "typename:const string", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_uri", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            const string _uri;$/", "language": "C++", "typeref": "typename:const string", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}, {"_type": "tag", "name": "_value", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                const string _value;$/", "language": "C++", "typeref": "typename:const string", "kind": "member", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "~Job", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^                ~Job() override$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class"}, {"_type": "tag", "name": "~Store2", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/CloudStore/grpc/Store2.h", "pattern": "/^            ~Store2() override$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class"}], "hash": "68c15810301c7a19cc59f8c3836a5cd0", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/entservices-infra/CloudStore/grpc/Store2.h", "fields": [{"name": "const bool _authorization", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::CriticalSection _clientLock", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "std::list<INotification * > _clients", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "const string _key", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}, {"name": "const string _ns", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}, {"name": "Store2 * _parent", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}, {"name": "const ScopeType _scope", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}, {"name": "PluginHost::IShell * _service", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "std::unique_ptr<::distp::gateway::secure_storage::v1::SecureStorageService::Stub> _stub", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "const string _token", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "const string _uri", "scope": "WPEFramework::Plugin::Grpc::Store2", "scopeKind": "class", "description": "unavailable"}, {"name": "const string _value", "scope": "WPEFramework::Plugin::Grpc::Store2::Job", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"447": ""}]}