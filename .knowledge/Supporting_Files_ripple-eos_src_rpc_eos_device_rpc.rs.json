{"is_source_file": true, "format": "Rust", "description": "This file defines a Rust implementation of a JSON-RPC server trait for device management, specifically provisioning and retrieving device identifiers (ID, MAC). It includes trait definitions, server implementation, auxiliary functions for obtaining device info, and session management logic.", "external_files": ["jsonrpsee::core", "jsonrpsee::proc_macros", "thunder_ripple_sdk::client::device_operator", "thunder_ripple_sdk::client::thunder_plugin", "thunder_ripple_sdk::ripple_sdk::api::gateway::rpc_gateway_api", "thunder_ripple_sdk::ripple_sdk::api::session::ProvisionRequest", "thunder_ripple_sdk::log", "crate::extn::thunder::thunder_session::ThunderSessionService", "crate::rpc::rpc_utils::rpc_err", "crate::state::distributor_state::DistributorState"], "external_methods": ["ThunderSessionService::get_account_session", "ThunderSessionService::set_provision", "DistributorState::get_account_session", "DistributorState::update_account_session", "DistributorState::get_thunder", "DistributorState::get_thunder_client", "ThunderSessionService::get_thunder"], "published": ["Device", "device.provision", "device.id", "device.distributor"], "classes": [{"name": "DeviceImpl", "description": "Implementation of the Device RPC trait, handling device provisioning and info retrieval, maintaining a DistributorState."}], "methods": [{"name": "provision( &self, ctx: CallContext, provision_request: ProvisionRequest, ) -> RpcResult<()>", "description": "Handles device provisioning logic, updating sessions, and calling Thunder service to set provision status.", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"name": "new(state: &DistributorState) -> Self", "description": "Constructor for DeviceImpl, initializes with a given DistributorState.", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"name": "id(&self, _ctx: CallContext) -> RpcResult<String>", "description": "Retrieves the device ID, either from session or MAC address.", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"name": "distributor(&self, _ctx: CallContext) -> RpcResult<String>", "description": "Fetches the distributor ID from the current account session.", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"name": "get_device_id(state: &DistributorState) -> RpcResult<String>", "description": "Gets the device ID, possibly using MAC address if session info is unavailable.", "scope": "", "scopeKind": ""}, {"name": "filter_mac(mac_address: String) -> String", "description": "Sanitizes a MAC address string by removing colons and validating format.", "scope": "", "scopeKind": ""}, {"name": "get_mac(state: &DistributorState) -> String", "description": "Calls Thunder service to retrieve device MAC address info.", "scope": "", "scopeKind": ""}, {"name": "distributor(&self, ctx: CallContext) -> RpcResult<String>", "scope": "Device", "scopeKind": "interface", "description": "unavailable"}, {"name": "id(&self, ctx: CallContext) -> RpcResult<String>", "scope": "Device", "scopeKind": "interface", "description": "unavailable"}, {"name": "provision( &self, mut _ctx: CallContext, provision_request: ProvisionRequest, ) -> RpcResult<()>", "scope": "DeviceImpl", "scopeKind": "implementation", "description": "unavailable"}], "calls": ["ThunderSessionService::get_account_session", "ThunderSessionService::set_provision", "state.get_account_session", "state.update_account_session", "state.get_thunder", "state.get_thunder_client", "client.call", "resp.message.get"], "search-terms": ["eos_device_rpc.rs", "jsonrpsee", "Device", "provision", "device.id", "distributor", "ThunderSession", "MAC address", "device provisioning", "RPC server"], "state": 2, "file_id": 2569, "knowledge_revision": 5141, "git_revision": "0f87a35b32215bc8547fb583d6c84bd51f603f69", "ctags": [{"_type": "tag", "name": "Device", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^pub trait Device {$/", "language": "Rust", "kind": "interface"}, {"_type": "tag", "name": "DeviceImpl", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^impl DeviceImpl {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "DeviceImpl", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^impl DeviceServer for DeviceImpl {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "DeviceImpl", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^pub struct DeviceImpl {$/", "language": "Rust", "kind": "struct"}, {"_type": "tag", "name": "distributor", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn distributor(&self, _ctx: CallContext) -> RpcResult<String> {$/", "language": "Rust", "kind": "method", "signature": "(&self, _ctx: CallContext) -> RpcResult<String>", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"_type": "tag", "name": "distributor", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn distributor(&self, ctx: CallContext) -> RpcResult<String>;$/", "language": "Rust", "kind": "method", "signature": "(&self, ctx: CallContext) -> RpcResult<String>", "scope": "Device", "scopeKind": "interface"}, {"_type": "tag", "name": "filter_mac", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^fn filter_mac(mac_address: String) -> String {$/", "language": "Rust", "kind": "function", "signature": "(mac_address: String) -> String"}, {"_type": "tag", "name": "get_device_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^pub(crate) async fn get_device_id(state: &DistributorState) -> RpcResult<String> {$/", "language": "Rust", "kind": "function", "signature": "(state: &DistributorState) -> RpcResult<String>"}, {"_type": "tag", "name": "get_mac", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^pub(crate) async fn get_mac(state: &DistributorState) -> String {$/", "language": "Rust", "kind": "function", "signature": "(state: &DistributorState) -> String"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn id(&self, _ctx: CallContext) -> RpcResult<String> {$/", "language": "Rust", "kind": "method", "signature": "(&self, _ctx: CallContext) -> RpcResult<String>", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn id(&self, ctx: CallContext) -> RpcResult<String>;$/", "language": "Rust", "kind": "method", "signature": "(&self, ctx: CallContext) -> RpcResult<String>", "scope": "Device", "scopeKind": "interface"}, {"_type": "tag", "name": "new", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    pub fn new(state: &DistributorState) -> Self {$/", "language": "Rust", "kind": "method", "signature": "(state: &DistributorState) -> Self", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"_type": "tag", "name": "provision", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn provision($/", "language": "Rust", "kind": "method", "signature": "( &self, ctx: CallContext, provision_request: ProvisionRequest, ) -> RpcResult<()>", "scope": "Device", "scopeKind": "interface"}, {"_type": "tag", "name": "provision", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn provision($/", "language": "Rust", "kind": "method", "signature": "( &self, ctx: CallContext, provision_request: ProvisionRequest, ) -> RpcResult<()>", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"_type": "tag", "name": "provision", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    async fn provision($/", "language": "Rust", "kind": "method", "signature": "( &self, mut _ctx: CallContext, provision_request: ProvisionRequest, ) -> RpcResult<()>", "scope": "DeviceImpl", "scopeKind": "implementation"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "pattern": "/^    pub state: DistributorState,$/", "language": "Rust", "kind": "field", "scope": "DeviceImpl", "scopeKind": "struct"}], "hash": "211e662e0b9560ebf810afbf8235450c", "format-version": 4, "code-base-name": "app-gateway2", "filename": "Supporting_Files/ripple-eos/src/rpc/eos_device_rpc.rs", "fields": [{"name": "pub trait Device {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pub state: DistributorState,", "scope": "DeviceImpl", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"5141": "0f87a35b32215bc8547fb583d6c84bd51f603f69"}]}