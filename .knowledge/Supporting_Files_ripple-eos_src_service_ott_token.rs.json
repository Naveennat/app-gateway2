{"is_source_file": true, "format": "Rust", "description": "This source file defines the `OttTokenService` struct and its implementation, providing functionality to retrieve OTT tokens via gRPC calls. It includes external dependencies, internal method definitions, and a test module.", "external_files": ["tonic::transport::Channel", "crate::gateway::appsanity_gateway::GrpcClientSession", "crate::message::DpabError", "crate::model::auth::GetOttTokenResponse", "crate::util::service_util::decorate_request_with_account_session", "ottx_protos::ott_token::ott_token_service_client::OttTokenServiceClient", "ottx_protos::ott_token::PlatformTokenRequest", "thunder_ripple_sdk::ripple_sdk::log::error", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession", "tonic::Request", "uuid::Uuid"], "external_methods": ["OttTokenServiceClient::with_interceptor", "client.platform_token", "decorate_request_with_account_session", "Uuid::new_v4"], "published": ["OttTokenService", "OttTokenService::new_from", "OttTokenService::get_ott_token"], "classes": [{"name": "OttTokenService", "description": "A service struct that manages OTT token retrieval via gRPC, encapsulating a session client with synchronization."}], "methods": [{"name": "get_channel(&self) -> Result<Channel, DpabError>", "description": "Retrieves a gRPC channel from the session, returning a result or an error.", "scope": "OttTokenService", "scopeKind": "implementation"}, {"name": "get_ott_token( &self, account_session: &AccountSession, app_id: String, xact: String, ) -> Result<GetOttTokenResponse, DpabError>", "description": "Asynchronously obtains an OTT token by calling the gRPC service with the provided account session, app ID, and transaction ID.", "scope": "OttTokenService", "scopeKind": "implementation"}, {"name": "new_from(grpc_client_session: Arc<Mutex<GrpcClientSession>>) -> OttTokenService", "description": "Constructs a new `OttTokenService` instance from a shared gRPC client session.", "scope": "OttTokenService", "scopeKind": "implementation"}, {"name": "mock() -> Self", "scope": "tests::OttTokenService", "scopeKind": "implementation", "description": "unavailable"}], "calls": ["self.get_channel()", "OttTokenServiceClient::with_interceptor", "client.platform_token", "decorate_request_with_account_session", "Uuid::new_v4()", "error!(\"Server returned {:?}\", err)"], "search-terms": ["OttTokenService", "platform_token", "gRPC channel", "OTT token retrieval", "async Rust service", "protobuf", "session lock"], "state": 2, "file_id": 336, "knowledge_revision": 1052, "git_revision": "046761b9656aa3448e0e16f1a3a9c084965a6b28", "ctags": [{"_type": "tag", "name": "OttTokenService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^    impl Mockable for OttTokenService {$/", "language": "Rust", "kind": "implementation", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "OttTokenService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^impl OttTokenService {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "OttTokenService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^pub struct OttTokenService {$/", "language": "Rust", "kind": "struct"}, {"_type": "tag", "name": "get_channel", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^    fn get_channel(&self) -> Result<Channel, DpabError> {$/", "language": "Rust", "kind": "method", "signature": "(&self) -> Result<Channel, DpabError>", "scope": "OttTokenService", "scopeKind": "implementation"}, {"_type": "tag", "name": "get_ott_token", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^    pub async fn get_ott_token($/", "language": "Rust", "kind": "method", "signature": "( &self, account_session: &AccountSession, app_id: String, xact: String, ) -> Result<GetOttTokenResponse, DpabError>", "scope": "OttTokenService", "scopeKind": "implementation"}, {"_type": "tag", "name": "grpc_client_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^    grpc_client_session: Arc<Mutex<GrpcClientSession>>,$/", "language": "Rust", "kind": "field", "scope": "OttTokenService", "scopeKind": "struct"}, {"_type": "tag", "name": "mock", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^        fn mock() -> Self {$/", "language": "Rust", "kind": "method", "signature": "() -> Self", "scope": "tests::OttTokenService", "scopeKind": "implementation"}, {"_type": "tag", "name": "new_from", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^    pub fn new_from(grpc_client_session: Arc<Mutex<GrpcClientSession>>) -> OttTokenService {$/", "language": "Rust", "kind": "method", "signature": "(grpc_client_session: Arc<Mutex<GrpcClientSession>>) -> OttTokenService", "scope": "OttTokenService", "scopeKind": "implementation"}, {"_type": "tag", "name": "tests", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/ott_token.rs", "pattern": "/^pub mod tests {$/", "language": "Rust", "kind": "module"}], "hash": "66cd8c0fdc72d57eb27b1ccd68b762de", "format-version": 4, "code-base-name": "app-gateway2", "filename": "Supporting_Files/ripple-eos/src/service/ott_token.rs", "fields": [{"name": "grpc_client_session: Arc<Mutex<GrpcClientSession>>,", "scope": "OttTokenService", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"1052": "046761b9656aa3448e0e16f1a3a9c084965a6b28"}]}