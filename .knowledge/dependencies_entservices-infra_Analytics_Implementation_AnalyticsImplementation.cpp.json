{"is_source_file": true, "format": "C++", "description": "This file implements the core logic of an Analytics component, including event handling, configuration, backend communication, and time synchronization. It defines classes and methods for sending events, managing configuration, and mapping event names, with threading and synchronization mechanisms.", "external_files": ["AnalyticsImplementation.h", "UtilsLogging.h", "LocalStore.h", "<fstream>", "<streambuf>", "<sys/sysinfo.h>"], "external_methods": ["Core::JSON::Container::Add", "Core::JSON::Container::FromString", "Core::JSON::Error::Message", "Core::Error", "jsonArray.FromString", "jsonArray.Length", "jsonObject.Object", "jsonObject.HasLabel", "jsonObject[].String", "map.find", "mBackendLoader.Load", "mBackendLoader.GetBackend", "ILog::SendEvent", "sysinfo", "GetCurrentTimestampInMs", "GetCurrentUptimeInMs", "ConvertUptimeToTimestampInMs"], "published": ["SendEvent"], "classes": [{"name": "AnalyticsConfig", "description": "Represents the JSON configuration for analytics, including event mapping and backend library path."}, {"name": "AnalyticsImplementation", "description": "Main class implementing the analytics event handling, configuration, and back-end communication, including thread management and event processing."}, {"name": "AnalyticsImplementation::EventMapper", "description": "Handles the mapping of event names based on JSON configuration."}], "methods": [{"name": "uint32_t Configure(PluginHost::IShell * shell)", "description": "Initializes the analytics component with the provided shell, loading configuration, backends, and setting up internal state.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "Core::hresult SendEvent(const string & eventName,const string & eventVersion,const string & eventSource,const string & eventSourceVersion,IStringIterator * const & cetList,const uint64_t epochTimestamp,const uint64_t uptimeTimestamp,const string & appId,const string & eventPayload)", "description": "Queues an event for processing, validating input parameters and adding it to the action queue.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "void ActionLoop()", "description": "Main thread loop processing queued actions, including event sending and system time validation.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "bool IsSysTimeValid()", "description": "Checks if system time and timezone are properly synchronized and valid.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "void SendEventToBackend(const AnalyticsImplementation::Event & event)", "description": "Converts internal event representation to backend format and dispatches it via the backend interface.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "void ParseEventsMapFile(const std::string & eventsMapFile)", "description": "Reads and parses the JSON event mapping file to initialize name mappings.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "uint64_t GetCurrentTimestampInMs()", "description": "Returns the current system timestamp in milliseconds.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "uint64_t GetCurrentUptimeInMs()", "description": "Returns the system uptime in milliseconds.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "uint64_t ConvertUptimeToTimestampInMs(uint64_t uptimeMs)", "description": "Converts an uptime duration in milliseconds to an absolute timestamp.", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"name": "AnalyticsConfig()", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "AnalyticsImplementation()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class", "description": "unavailable"}, {"name": "void FromString(const std::string & jsonArrayStr)", "scope": "WPEFramework::Plugin::AnalyticsImplementation::EventMapper", "scopeKind": "class", "description": "unavailable"}, {"name": "std::string MapEventNameIfNeeded(const std::string & eventName,const std::string & eventSource,const std::string & eventSourceVersion,const std::string & eventVersion) const", "scope": "WPEFramework::Plugin::AnalyticsImplementation::EventMapper", "scopeKind": "class", "description": "unavailable"}, {"name": "{ return !mActionQueue.empty(); }); __anon72f90ca10102", "scope": "WPEFramework::Plugin::AnalyticsImplementation::ActionLoop", "scopeKind": "function", "description": "unavailable"}, {"name": "{ return !mActionQueue.empty(); }); __anon72f90ca10202", "scope": "WPEFramework::Plugin::AnalyticsImplementation::ActionLoop", "scopeKind": "function", "description": "unavailable"}, {"name": "~AnalyticsConfig()", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "~AnalyticsImplementation()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class", "description": "unavailable"}], "calls": ["mBackendLoader.Load", "mBackendLoader.GetBackend", "mEventMapper.FromString", "mEventMapper.MapEventNameIfNeeded", "mSysTime->IsSystemTimeAvailable", "mSysTime->GetTimeZoneOffset", "sysinfo", "std::this_thread::sleep_for", "mBackends.begin", "mBackends.end", "mBackends.begin()->second->SendEvent", "mBackends.begin()->first", "fopen", "ifstream::operator()", "Core::JSON::Container::FromString"], "search-terms": ["AnalyticsImplementation", "EventMapper", "Configure", "SendEvent", "ActionLoop", "SystemTime", "BackendLoader", "EventMapping", "UptimeToTimestamp", "Thread", "Mutex", "Queue", "Configuration"], "state": 2, "file_id": 3586, "knowledge_revision": 7483, "git_revision": "", "ctags": [{"_type": "tag", "name": "ActionLoop", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    void AnalyticsImplementation::ActionLoop()$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "AnalyticsConfig", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^            AnalyticsConfig()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class"}, {"_type": "tag", "name": "AnalyticsConfig", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    class AnalyticsConfig : public Core::JSON::Container {$/", "file": true, "language": "C++", "kind": "class", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "AnalyticsImplementation", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    AnalyticsImplementation::AnalyticsImplementation():$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "BackendLib", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^            Core::JSON::String BackendLib;$/", "file": true, "language": "C++", "typeref": "typename:Core::JSON::String", "kind": "member", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class"}, {"_type": "tag", "name": "Configure", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    uint32_t AnalyticsImplementation::Configure(PluginHost::IShell* shell)$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(PluginHost::IShell * shell)", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "ConvertUptimeToTimestampInMs", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    uint64_t AnalyticsImplementation::ConvertUptimeToTimestampInMs(uint64_t uptimeMs)$/", "language": "C++", "typeref": "typename:uint64_t", "kind": "function", "signature": "(uint64_t uptimeMs)", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "EventsMap", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^            Core::JSON::String EventsMap;$/", "file": true, "language": "C++", "typeref": "typename:Core::JSON::String", "kind": "member", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class"}, {"_type": "tag", "name": "FromString", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    void AnalyticsImplementation::EventMapper::FromString(const std::string &jsonArrayStr)$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const std::string & jsonArrayStr)", "scope": "WPEFramework::Plugin::AnalyticsImplementation::EventMapper", "scopeKind": "class"}, {"_type": "tag", "name": "GetCurrentTimestampInMs", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    uint64_t AnalyticsImplementation::GetCurrentTimestampInMs()$/", "language": "C++", "typeref": "typename:uint64_t", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "GetCurrentUptimeInMs", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    uint64_t AnalyticsImplementation::GetCurrentUptimeInMs()$/", "language": "C++", "typeref": "typename:uint64_t", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "IsSysTimeValid", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    bool AnalyticsImplementation::IsSysTimeValid()$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "MapEventNameIfNeeded", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    std::string AnalyticsImplementation::EventMapper::MapEventNameIfNeeded(const std::string &ev/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(const std::string & eventName,const std::string & eventSource,const std::string & eventSourceVersion,const std::string & eventVersion) const", "scope": "WPEFramework::Plugin::AnalyticsImplementation::EventMapper", "scopeKind": "class"}, {"_type": "tag", "name": "POPULATE_DEVICE_INFO_RETRY_MS", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    const uint32_t POPULATE_DEVICE_INFO_RETRY_MS = 3000;$/", "language": "C++", "typeref": "typename:const uint32_t", "kind": "variable", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "ParseEventsMapFile", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    void AnalyticsImplementation::ParseEventsMapFile(const std::string& eventsMapFile)$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const std::string & eventsMapFile)", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^namespace Plugin {$/", "file": true, "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "SendEvent", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    \\/* virtual *\\/ Core::hresult AnalyticsImplementation::SendEvent(const string& eventName,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const string & eventName,const string & eventVersion,const string & eventSource,const string & eventSourceVersion,IStringIterator * const & cetList,const uint64_t epochTimestamp,const uint64_t uptimeTimestamp,const string & appId,const string & eventPayload)", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "SendEventToBackend", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    void AnalyticsImplementation::SendEventToBackend(const AnalyticsImplementation::Event& event/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const AnalyticsImplementation::Event & event)", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^namespace WPEFramework {$/", "file": true, "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "__anon72f90ca10102", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^                                         { return !mActionQueue.empty(); });$/", "file": true, "language": "C++", "kind": "function", "scope": "WPEFramework::Plugin::AnalyticsImplementation::ActionLoop", "scopeKind": "function"}, {"_type": "tag", "name": "__anon72f90ca10202", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^                                             { return !mActionQueue.empty(); });$/", "file": true, "language": "C++", "kind": "function", "scope": "WPEFramework::Plugin::AnalyticsImplementation::ActionLoop", "scopeKind": "function"}, {"_type": "tag", "name": "~AnalyticsConfig", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^            ~AnalyticsConfig()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class"}, {"_type": "tag", "name": "~AnalyticsImplementation", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "pattern": "/^    AnalyticsImplementation::~AnalyticsImplementation()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::AnalyticsImplementation", "scopeKind": "class"}], "hash": "02c960d10252eb462b9ceca643bc0efe", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/entservices-infra/Analytics/Implementation/AnalyticsImplementation.cpp", "fields": [{"name": "Core::JSON::String BackendLib", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::JSON::String EventsMap", "scope": "WPEFramework::Plugin::AnalyticsConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "const uint32_t POPULATE_DEVICE_INFO_RETRY_MS", "scope": "WPEFramework::Plugin", "scopeKind": "namespace", "description": "unavailable"}], "revision_history": [{"7483": ""}]}