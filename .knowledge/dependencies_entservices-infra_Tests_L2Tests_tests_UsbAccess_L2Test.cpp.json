{"is_source_file": true, "format": "C++", "description": "This file is a test source file for the UsbAccess module. It implements unit tests using Google Test framework for various methods and events related to USB access such as getFileList, FirmwareUpdate, SymLinkoperations, and event subscriptions like onUSBMountChanged and onArchiveLogs. The tests mock external dependencies and verify the correct behavior and event handling of the module.", "external_files": ["L2Tests.h", "L2TestsMock.h", "<gtest/gtest.h>", "<gmock/gmock.h>", "<fstream>"], "external_methods": ["IARM_Bus_RegisterEventHandler", "IARM_Bus_SYSMgr_EventData_t", "Core::JSONRPC::Message", "jsonrpc.Subscribe", "jsonrpc.Unsubscribe", "InvokeServiceMethod", "DeactivatService", "ActivateService"], "published": ["UsbAccess_L2test", "MatchRequestStatus", "onUSBMountChanged", "onArchiveLogs"], "classes": [{"name": "AsyncHandlerMock_USB", "description": "Mock class for handling USB events, used in testing event callbacks such as onUSBMountChanged and onArchiveLogs."}, {"name": "UsbAccess_L2test", "description": "Unit test class for the UsbAccess module, containing setup, mock expectations, and individual test cases for methods like getFileList, FirmwareUpdate, SymLinkoperations, and event subscriptions."}], "methods": [{"name": "UsbAccess_L2test()", "description": "Constructor initializes mocks and registers event handlers, activates the UsbAccess service, and sets a device property.", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"name": "~UsbAccess_L2test()", "description": "Destructor deactivates the UsbAccess service.", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"name": "uint32_t WaitForRequestStatus(uint32_t timeout_ms,UsbAccessL2test_async_events_t expected_status)", "description": "Waits for a specific asynchronous event status within a timeout period.", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"name": "void onUSBMountChanged(const JsonObject & message)", "description": "Callback invoked when USB mount status changes.", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"name": "void onArchiveLogs(const JsonObject & message)", "description": "Callback invoked when archive logs event occurs.", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"name": "std::string verify_getFileListContents(string * str1)", "description": "Verifies and cleans the contents of getFileList response for comparison.", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"name": "AsyncHandlerMock_USB()", "scope": "AsyncHandlerMock_USB", "scopeKind": "class", "description": "unavailable"}, {"name": "TEST_F(UsbAccess_L2test,FileList)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(UsbAccess_L2test,FirmwareUpdate)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(UsbAccess_L2test,SymLinkoperations)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(UsbAccess_L2test,UsbAccessArchiveLogs)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "__anonaa6154840202(const char* ownerName, IARM_EventId_t eventId, IARM_EventHandler_t handler)", "scope": "UsbAccess_L2test::UsbAccess_L2test", "scopeKind": "function", "description": "unavailable"}, {"name": "struct:mntent * __anonaa6154840302(FILE*)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}, {"name": "struct:mntent * __anonaa6154840402(FILE*)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}, {"name": "struct:mntent * __anonaa6154840502(FILE*)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}, {"name": "__anonaa6154840602(const char* command, va_list args)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}, {"name": "struct:mntent * __anonaa6154840702(FILE*)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}, {"name": "struct:mntent * __anonaa6154840802(FILE*)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}, {"name": "FILE * __anonaa6154840902(const char *direction, const char *command, va_list args)", "scope": "TEST_F", "scopeKind": "function", "description": "unavailable"}], "calls": ["IARM_Bus_SYSMgr_EventData_t", "jsonrpc.Subscribe", "jsonrpc.Unsubscribe", "InvokeServiceMethod", "DeactivatService", "ActivateService", "p_iarmBusImplMock.IARM_Bus_RegisterEventHandler", "p_udevImplMock.udev_enumerate_get_list_entry", "p_udevImplMock.udev_list_entry_get_name", "p_udevImplMock.udev_device_get_parent_with_subsystem_devtype", "p_udevImplMock.udev_device_get_devtype", "p_udevImplMock.udev_device_get_devnode", "p_wrapsImplMock.getmntent", "p_wrapsImplMock.v_secure_system", "p_wrapsImplMock.v_secure_popen", "ActivateService", "DeactivateService", "InvokeServiceMethod", "jsonrpc.Subscribe", "jsonrpc.Unsubscribe"], "search-terms": ["UsbAccess", "getFileList", "FirmwareUpdate", "SymLinkoperations", "onUSBMountChanged", "onArchiveLogs", "Mocks", "GTest", "unit test", "mocked event handler", "system call mock", "subscribe event", "unsubscribe event"], "state": 2, "file_id": 300, "knowledge_revision": 663, "git_revision": "", "ctags": [{"_type": "tag", "name": "AsyncHandlerMock_USB", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^\t\tAsyncHandlerMock_USB()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "AsyncHandlerMock_USB", "scopeKind": "class"}, {"_type": "tag", "name": "AsyncHandlerMock_USB", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^class AsyncHandlerMock_USB$/", "file": true, "language": "C++", "kind": "class"}, {"_type": "tag", "name": "JSON_TIMEOUT", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^#define JSON_TIMEOUT /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^TEST_F(UsbAccess_L2test, FileList)$/", "language": "C++", "kind": "function", "signature": "(UsbAccess_L2test,FileList)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^TEST_F(UsbAccess_L2test, FirmwareUpdate)$/", "language": "C++", "kind": "function", "signature": "(UsbAccess_L2test,FirmwareUpdate)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^TEST_F(UsbAccess_L2test, SymLinkoperations)$/", "language": "C++", "kind": "function", "signature": "(UsbAccess_L2test,SymLinkoperations)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^TEST_F(UsbAccess_L2test,UsbAccessArchiveLogs)$/", "language": "C++", "kind": "function", "signature": "(UsbAccess_L2test,UsbAccessArchiveLogs)"}, {"_type": "tag", "name": "TEST_LOG", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^#define TEST_LOG(/", "file": true, "language": "C++", "kind": "macro", "signature": "(x,...)"}, {"_type": "tag", "name": "USBACCESSL2TEST_CALLSIGN", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^#define USBACCESSL2TEST_CALLSIGN /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "USBACCESS_CALLSIGN", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^#define USBACCESS_CALLSIGN /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "UsbAccessL2test_async_events_t", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^}UsbAccessL2test_async_events_t;$/", "file": true, "language": "C++", "typeref": "enum:__anonaa6154840103", "kind": "typedef"}, {"_type": "tag", "name": "UsbAccess_L2test", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^UsbAccess_L2test:: UsbAccess_L2test():L2TestMocks()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "UsbAccess_L2test", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^class UsbAccess_L2test : public L2TestMocks {$/", "file": true, "language": "C++", "kind": "class"}, {"_type": "tag", "name": "UsbAccess_StateInvalid", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^    UsbAccess_StateInvalid = 0x00000000$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "__anonaa6154840103", "scopeKind": "enum"}, {"_type": "tag", "name": "UsbAccess_onArchieveLogs", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^    UsbAccess_onArchieveLogs = 0x00000002,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "__anonaa6154840103", "scopeKind": "enum"}, {"_type": "tag", "name": "UsbAccess_onUSBMountChanged", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^    UsbAccess_onUSBMountChanged = 0x00000001,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "__anonaa6154840103", "scopeKind": "enum"}, {"_type": "tag", "name": "WaitForRequestStatus", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^uint32_t UsbAccess_L2test::WaitForRequestStatus(uint32_t timeout_ms, UsbAccessL2test_async_event/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(uint32_t timeout_ms,UsbAccessL2test_async_events_t expected_status)", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "__anonaa6154840103", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^typedef enum : uint32_t {$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "enum"}, {"_type": "tag", "name": "__anonaa6154840202", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^                [&](const char* ownerName, IARM_EventId_t eventId, IARM_EventHandler_t handler) /", "file": true, "language": "C++", "kind": "function", "signature": "(const char* ownerName, IARM_EventId_t eventId, IARM_EventHandler_t handler) ", "scope": "UsbAccess_L2test::UsbAccess_L2test", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840302", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^       [&](FILE*) -> struct mntent* {$/", "file": true, "language": "C++", "typeref": "struct:mntent *", "kind": "function", "signature": "(FILE*) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840402", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^       [&](FILE*) -> struct mntent* {$/", "file": true, "language": "C++", "typeref": "struct:mntent *", "kind": "function", "signature": "(FILE*) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840502", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^       [&](FILE*) -> struct mntent* {$/", "file": true, "language": "C++", "typeref": "struct:mntent *", "kind": "function", "signature": "(FILE*) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840602", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^            [&](const char* command, va_list args) {$/", "file": true, "language": "C++", "kind": "function", "signature": "(const char* command, va_list args) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840702", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^       [&](FILE*) -> struct mntent* {$/", "file": true, "language": "C++", "typeref": "struct:mntent *", "kind": "function", "signature": "(FILE*) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840802", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^       [&](FILE*) -> struct mntent* {$/", "file": true, "language": "C++", "typeref": "struct:mntent *", "kind": "function", "signature": "(FILE*) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "__anonaa6154840902", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        [&](const char *direction, const char *command, va_list args) -> FILE* {$/", "file": true, "language": "C++", "typeref": "typename:FILE *", "kind": "function", "signature": "(const char *direction, const char *command, va_list args) ", "scope": "TEST_F", "scopeKind": "function"}, {"_type": "tag", "name": "actual", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^    std::string actual;$/", "language": "C++", "typeref": "typename:std::string", "kind": "variable"}, {"_type": "tag", "name": "buffer", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^char buffer[1024];$/", "language": "C++", "typeref": "typename:char[1024]", "kind": "variable"}, {"_type": "tag", "name": "expected", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^    std::string expected;$/", "language": "C++", "typeref": "typename:std::string", "kind": "variable"}, {"_type": "tag", "name": "iarmEventHandler", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        IARM_EventHandler_t iarmEventHandler = nullptr;$/", "file": true, "language": "C++", "typeref": "typename:IARM_EventHandler_t", "kind": "member", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "m_condition_variable", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        std::condition_variable m_condition_variable;$/", "file": true, "language": "C++", "typeref": "typename:std::condition_variable", "kind": "member", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "m_event_signalled", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        uint32_t m_event_signalled;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "m_mutex", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        std::mutex m_mutex;$/", "file": true, "language": "C++", "typeref": "typename:std::mutex", "kind": "member", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "match", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^    bool match = true;$/", "language": "C++", "typeref": "typename:bool", "kind": "variable"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        Core::JSONRPC::Message message;$/", "file": true, "language": "C++", "typeref": "typename:Core::JSONRPC::Message", "kind": "member", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "onArchiveLogs", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^void UsbAccess_L2test::onArchiveLogs(const JsonObject &message)$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const JsonObject & message)", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "onUSBMountChanged", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^void UsbAccess_L2test::onUSBMountChanged(const JsonObject &message)$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const JsonObject & message)", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "response", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^        string response;$/", "file": true, "language": "C++", "typeref": "typename:string", "kind": "member", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "verify_getFileListContents", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^std::string UsbAccess_L2test::verify_getFileListContents(string *str1)$/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(string * str1)", "scope": "UsbAccess_L2test", "scopeKind": "class"}, {"_type": "tag", "name": "~UsbAccess_L2test", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "pattern": "/^UsbAccess_L2test:: ~UsbAccess_L2test(){$/", "language": "C++", "kind": "function", "signature": "()", "scope": "UsbAccess_L2test", "scopeKind": "class"}], "hash": "1feec2852cfba6876481b04292947826", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/entservices-infra/Tests/L2Tests/tests/UsbAccess_L2Test.cpp", "fields": [{"name": "std::string actual", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[1024] buffer", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "std::string expected", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "IARM_EventHandler_t iarmEventHandler", "scope": "UsbAccess_L2test", "scopeKind": "class", "description": "unavailable"}, {"name": "std::condition_variable m_condition_variable", "scope": "UsbAccess_L2test", "scopeKind": "class", "description": "unavailable"}, {"name": "uint32_t m_event_signalled", "scope": "UsbAccess_L2test", "scopeKind": "class", "description": "unavailable"}, {"name": "std::mutex m_mutex", "scope": "UsbAccess_L2test", "scopeKind": "class", "description": "unavailable"}, {"name": "bool match", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Core::JSONRPC::Message message", "scope": "UsbAccess_L2test", "scopeKind": "class", "description": "unavailable"}, {"name": "string response", "scope": "UsbAccess_L2test", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"663": ""}]}