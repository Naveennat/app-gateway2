{"is_source_file": true, "format": "rust", "description": "This file implements the 'AppsanityAdvertisingService' which interacts with external ad platform services, handles ad identifier retrieval, reset, and configuration fetching, utilizing gRPC and HTTP APIs. It also includes helper functions, tests, and data structures relevant to advertising configuration and identity management.", "external_files": ["crate::client::xvp_xifaservice", "crate::gateway::appsanity_gateway", "crate::message::DpabError", "crate::util::service_util", "base64", "ottx_protos::ad_platform", "thunder_ripple_sdk::ripple_sdk::api::firebolt::fb_advertising", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession", "thunder_ripple_sdk::ripple_sdk::log", "serde", "serde_json", "std::collections::HashMap", "std::sync::{Arc, Mutex}", "tonic::Request"], "external_methods": ["XvpXifaService::get_ad_identifier", "XvpXifaService::reset_ad_identifier", "decorate_request_with_account_session", "AdPlatformServiceClient::with_interceptor", "AdPlatformServiceClient::get_ad_router"], "published": ["serialize_object"], "classes": [{"name": "AppsanityAdvertisingService", "description": "Main service class providing methods to fetch and reset ad identifiers and get ad configuration."}, {"name": "XvpServiceUrl", "description": "Holds the URL for the XVP XIFA service, providing a constructor and accessor."}], "methods": [{"name": "XvpServiceUrl::new", "description": "Creates a new instance of XvpServiceUrl with the provided URL."}, {"name": "XvpServiceUrl::get_xvp_xifa_url", "description": "Returns a reference to the stored URL."}, {"name": "AppsanityAdvertisingService::new", "description": "Constructor for AppsanityAdvertisingService, initializing with session and URL."}, {"name": "AppsanityAdvertisingService::get_ad_identifier", "description": "Fetches an ad identifier from XvpXifaService, returning a structured response or error."}, {"name": "AppsanityAdvertisingService::reset_ad_identifier", "description": "Resets the ad identifier via XvpXifaService."}, {"name": "AppsanityAdvertisingService::get_ad_config", "description": "Retrieves ad configuration, including gRPC channel interaction, and constructs the response including AdRouter data."}, {"name": "serialize_object<T: Serialize>(obj: T) -> Result<String, Error>", "description": "Serializes a given object to JSON, encodes it with base64, and returns as string.", "scope": "", "scopeKind": ""}, {"name": "get_ad_config( self: Self, params: AdConfigRequestParams, ) -> Result<AdConfigResponse, DpabError>", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation", "description": "unavailable"}, {"name": "get_ad_identifier( self: Self, params: AdIdRequestParams, ) -> Result<AdIdResponse, DpabError>", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation", "description": "unavailable"}, {"name": "get_service(url: String) -> Box<AppsanityAdvertisingService>", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "get_session() -> AccountSession", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "get_xifa_response() -> XvpXifaServiceResponse", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "get_xvp_xifa_url(&self) -> &str", "scope": "XvpServiceUrl", "scopeKind": "implementation", "description": "unavailable"}, {"name": "mock_xifa_response(server: &MockServer) -> httpmock::Mock<'_>", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "new( grpc_client_session: Arc<Mutex<GrpcClientSession>>, xvp_service_url: XvpServiceUrl, ) -> Self", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation", "description": "unavailable"}, {"name": "new(xvp_xifa_url: String) -> Self", "scope": "XvpServiceUrl", "scopeKind": "implementation", "description": "unavailable"}, {"name": "reset_ad_identifier(self: Self, params: AccountSession) -> Result<(), DpabError>", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation", "description": "unavailable"}, {"name": "test_get_ad_config()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "test_get_ad_id_object()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "test_reset_ad_id()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "calls": ["XvpXifaService::get_ad_identifier", "XvpXifaService::reset_ad_identifier", "decorate_request_with_account_session", "AdPlatformServiceClient::with_interceptor", "client.get_ad_router", "to_string", "base64.encode", "serde_json::to_string"], "search-terms": ["AppsanityAdvertisingService", "get_ad_identifier", "reset_ad_identifier", "XvpXifaService", "ad_server_url", "get_ad_config", "serialize_object", "ad_profile_id"], "state": 2, "file_id": 339, "knowledge_revision": 1060, "git_revision": "046761b9656aa3448e0e16f1a3a9c084965a6b28", "ctags": [{"_type": "tag", "name": "AppsanityAdvertisingService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^impl AppsanityAdvertisingService {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "AppsanityAdvertisingService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^pub struct AppsanityAdvertisingService {$/", "language": "Rust", "kind": "struct"}, {"_type": "tag", "name": "XvpServiceUrl", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^impl XvpServiceUrl {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "XvpServiceUrl", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^pub struct XvpServiceUrl {$/", "language": "Rust", "kind": "struct"}, {"_type": "tag", "name": "get_ad_config", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub async fn get_ad_config($/", "language": "Rust", "kind": "method", "signature": "( self: Self, params: AdConfigRequestParams, ) -> Result<AdConfigResponse, DpabError>", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation"}, {"_type": "tag", "name": "get_ad_identifier", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub async fn get_ad_identifier($/", "language": "Rust", "kind": "method", "signature": "( self: Self, params: AdIdRequestParams, ) -> Result<AdIdResponse, DpabError>", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation"}, {"_type": "tag", "name": "get_service", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    fn get_service(url: String) -> Box<AppsanityAdvertisingService> {$/", "language": "Rust", "kind": "function", "signature": "(url: String) -> Box<AppsanityAdvertisingService>", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "get_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    fn get_session() -> AccountSession {$/", "language": "Rust", "kind": "function", "signature": "() -> AccountSession", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "get_xifa_response", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    fn get_xifa_response() -> XvpXifaServiceResponse {$/", "language": "Rust", "kind": "function", "signature": "() -> XvpXifaServiceResponse", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "get_xvp_xifa_url", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub fn get_xvp_xifa_url(&self) -> &str {$/", "language": "Rust", "kind": "method", "signature": "(&self) -> &str", "scope": "XvpServiceUrl", "scopeKind": "implementation"}, {"_type": "tag", "name": "grpc_client_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub grpc_client_session: Arc<Mutex<GrpcClientSession>>,$/", "language": "Rust", "kind": "field", "scope": "AppsanityAdvertisingService", "scopeKind": "struct"}, {"_type": "tag", "name": "mock_xifa_response", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub fn mock_xifa_response(server: &MockServer) -> httpmock::Mock<'_> {$/", "language": "Rust", "kind": "function", "signature": "(server: &MockServer) -> httpmock::Mock<'_>", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "new", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub fn new($/", "language": "Rust", "kind": "method", "signature": "( grpc_client_session: Arc<Mutex<GrpcClientSession>>, xvp_service_url: XvpServiceUrl, ) -> Self", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation"}, {"_type": "tag", "name": "new", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub fn new(xvp_xifa_url: String) -> Self {$/", "language": "Rust", "kind": "method", "signature": "(xvp_xifa_url: String) -> Self", "scope": "XvpServiceUrl", "scopeKind": "implementation"}, {"_type": "tag", "name": "reset_ad_identifier", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub async fn reset_ad_identifier(self: Self, params: AccountSession) -> Result<(), DpabError/", "language": "Rust", "kind": "method", "signature": "(self: Self, params: AccountSession) -> Result<(), DpabError>", "scope": "AppsanityAdvertisingService", "scopeKind": "implementation"}, {"_type": "tag", "name": "serialize_object", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^pub fn serialize_object<T: Serialize>(obj: T) -> Result<String, Error> {$/", "language": "Rust", "kind": "function", "signature": "<T: Serialize>(obj: T) -> Result<String, Error>"}, {"_type": "tag", "name": "test_get_ad_config", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub async fn test_get_ad_config() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "test_get_ad_id_object", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub async fn test_get_ad_id_object() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "test_reset_ad_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub async fn test_reset_ad_id() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "tests", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^pub mod tests {$/", "language": "Rust", "kind": "module"}, {"_type": "tag", "name": "xvp_service_url", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub xvp_service_url: XvpServiceUrl,$/", "language": "Rust", "kind": "field", "scope": "AppsanityAdvertisingService", "scopeKind": "struct"}, {"_type": "tag", "name": "xvp_xifa_url", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "pattern": "/^    pub xvp_xifa_url: String,$/", "language": "Rust", "kind": "field", "scope": "XvpServiceUrl", "scopeKind": "struct"}], "hash": "9fed017e20cfe4428387b259dd900dce", "format-version": 4, "code-base-name": "app-gateway2", "filename": "Supporting_Files/ripple-eos/src/service/appsanity_advertising.rs", "fields": [{"name": "pub grpc_client_session: Arc<Mutex<GrpcClientSession>>,", "scope": "AppsanityAdvertisingService", "scopeKind": "struct", "description": "unavailable"}, {"name": "pub xvp_service_url: XvpServiceUrl,", "scope": "AppsanityAdvertisingService", "scopeKind": "struct", "description": "unavailable"}, {"name": "pub xvp_xifa_url: String,", "scope": "XvpServiceUrl", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"1060": "046761b9656aa3448e0e16f1a3a9c084965a6b28"}]}