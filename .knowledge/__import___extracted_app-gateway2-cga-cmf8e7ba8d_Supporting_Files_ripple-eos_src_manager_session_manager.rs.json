{"is_source_file": true, "format": "Rust", "description": "This Rust source file manages session handling, including subscribing to session token change events, handling session lifecycle, performing retries with exponential backoff for session data availability, and updating session state within a larger service architecture.", "external_files": ["crate::extn::thunder::events::comcast_thunder_event_handlers::SessionTokenChangeHandler", "crate::extn::thunder::thunder_session::ThunderSessionService", "crate::state::distributor_state::DistributorState", "thunder_ripple_sdk::client::device_operator::DeviceOperator", "thunder_ripple_sdk::client::device_operator::DeviceResponseMessage", "thunder_ripple_sdk::client::device_operator::DeviceSubscribeRequest", "thunder_ripple_sdk::events::thunder_event_processor::ThunderEventHandlerProvider", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession", "tokio::sync::mpsc"], "external_methods": ["crate::extn::thunder::events::comcast_thunder_event_handlers::SessionTokenChangeHandler::event_name", "crate::extn::thunder::thunder_session::ThunderSessionService::get_account_session", "crate::extn::thunder::thunder_session::ThunderSessionService::get_sat_token", "crate::state::distributor_state::DistributorState::get_thunder", "crate::state::distributor_state::DistributorState::clone", "crate::state::distributor_state::DistributorState::update_account_session", "crate::state::distributor_state::DistributorState::handle_first_account_session_update"], "published": ["crate::manager::session_manager::handle_session", "crate::manager::session_manager::token_available_check_session"], "classes": [], "methods": [{"name": "setup_session_listener(distributor_state: &DistributorState)", "description": "Initializes session token change event subscription, sets up an asynchronous loop to handle token change events, and manages session state updates including retries with exponential backoff.", "scope": "", "scopeKind": ""}, {"name": "token_available_check_session(distributor_state: DistributorState) -> Result<(), u64>", "description": "Attempts to retrieve the account session with retries using exponential backoff; returns Ok if successful or Err with total backoff duration if not.", "scope": "", "scopeKind": ""}, {"name": "handle_session(distributor_state: DistributorState)", "description": "Sets up the session listener and retrieves the current session, updating state accordingly.", "scope": "", "scopeKind": ""}, {"name": "handle_first_session_load(distributor_state: DistributorState, session: AccountSession)", "description": "Updates the distributor state with the first loaded session and triggers subsequent handling.", "scope": "", "scopeKind": ""}, {"name": "handle_token_update(distributor_state: DistributorState)", "description": "Fetches the latest SAT token and updates the distributor state if the token is non-empty.", "scope": "", "scopeKind": ""}, {"name": "increment()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "no_token_on_startup()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "reset()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "test_already_activated_session()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "token_available_check_session_back_off()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "calls": ["client.subscribe", "distributor_state.get_thunder", "SessionTokenChangeHandler::event_name", "ThunderSessionService::get_account_session", "handle_token_update", "tokio::spawn", "distributor_state.update_account_session", "distributor_state.handle_first_account_session_update", "ThunderSessionService::get_sat_token", "tokio::time::sleep", "Duration::from_millis"], "search-terms": ["session setup", "token change event", "exponential backoff", "session lifecycle", "Rust async", "ThunderSessionService", "device subscription", "session retry", "session management"], "state": 2, "file_id": 1833, "knowledge_revision": 4427, "git_revision": "0f87a35b32215bc8547fb583d6c84bd51f603f69", "ctags": [{"_type": "tag", "name": "LOCAL_TEST_ID", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    static LOCAL_TEST_ID: AtomicU64 = AtomicU64::new(0);$/", "language": "Rust", "kind": "variable", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "handle_first_session_load", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^fn handle_first_session_load(distributor_state: DistributorState, session: AccountSession) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState, session: AccountSession)"}, {"_type": "tag", "name": "handle_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^pub async fn handle_session(distributor_state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState)"}, {"_type": "tag", "name": "handle_token_update", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn handle_token_update(distributor_state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState)"}, {"_type": "tag", "name": "increment", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    fn increment() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "no_token_on_startup", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn no_token_on_startup() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "reset", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    fn reset() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "setup_session_listener", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn setup_session_listener(distributor_state: &DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: &DistributorState)"}, {"_type": "tag", "name": "test_already_activated_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn test_already_activated_session() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "tests", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^pub mod tests {$/", "language": "Rust", "kind": "module"}, {"_type": "tag", "name": "token_available_check_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn token_available_check_session(distributor_state: DistributorState) -> Result<(), u64> {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState) -> Result<(), u64>"}, {"_type": "tag", "name": "token_available_check_session_back_off", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn token_available_check_session_back_off() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}], "hash": "6684a4938b1998a2a286db618cfb7a4f", "format-version": 4, "code-base-name": "app-gateway2", "filename": "__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "fields": [{"name": "static LOCAL_TEST_ID: AtomicU64 = AtomicU64::new(0);", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "revision_history": [{"4427": "0f87a35b32215bc8547fb583d6c84bd51f603f69"}]}