{"is_source_file": true, "format": "Rust", "description": "This Rust source file is a session manager module responsible for handling session setup, listening for token change events, retrying with exponential backoff, and updating session state within a larger system. It includes functions to subscribe to session token change events, handle session data, and implement retry logic for obtaining session information.", "external_files": ["crate::extn::thunder::events::comcast_thunder_event_handlers::SessionTokenChangeHandler", "crate::extn::thunder::thunder_session::ThunderSessionService", "crate::state::distributor_state::DistributorState", "thunder_ripple_sdk::client::device_operator::{DeviceOperator, DeviceResponseMessage, DeviceSubscribeRequest}", "thunder_ripple_sdk::events::thunder_event_processor::ThunderEventHandlerProvider", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession", "tokio::sync::mpsc"], "external_methods": ["SessionTokenChangeHandler::event_name", "SessionTokenChangeHandler::module", "ThunderSessionService::get_account_session", "ThunderSessionService::get_sat_token", "distributor_state.get_thunder", "distributor_state.get_account_session", "distributor_state.update_account_session", "distributor_state.handle_first_account_session_update", "distributor_state.update_token"], "published": ["handle_session", "token_available_check_session"], "classes": [], "methods": [{"name": "setup_session_listener(distributor_state: &DistributorState)", "description": "Sets up an asynchronous listener for session token change events, subscribes to such events, and spawns a task to handle incoming events, updating the session state as appropriate.", "scope": "", "scopeKind": ""}, {"name": "token_available_check_session(distributor_state: DistributorState) -> Result<(), u64>", "description": "Implements an exponential backoff retry mechanism to obtain an account session, retrying until success or maximum retries are reached, and handles the first session load.", "scope": "", "scopeKind": ""}, {"name": "handle_session(distributor_state: DistributorState)", "description": "Public async function to initialize session handling by setting up listeners and attempting to fetch the current session.", "scope": "", "scopeKind": ""}, {"name": "handle_first_session_load(distributor_state: DistributorState, session: AccountSession)", "description": "Handles the initial loading of session data into the distributor state and spawns a task for further processing.", "scope": "", "scopeKind": ""}, {"name": "handle_token_update(distributor_state: DistributorState)", "description": "Fetches and updates the session token in the distributor state.", "scope": "", "scopeKind": ""}, {"name": "increment()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "no_token_on_startup()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "reset()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "test_already_activated_session()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "token_available_check_session_back_off()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "calls": ["client.subscribe", "sub_rx.recv", "dist_c.get_account_session", "handle_token_update", "ThunderSessionService::get_account_session", "tokio::time::sleep", "ThunderSessionService::get_sat_token", "distributor_state.update_token", "distributor_state.get_thunder", "distributor_state.update_account_session", "distributor_state.handle_first_account_session_update"], "search-terms": ["session token change", "exponential backoff", "session listener", "session manager", "session setup", "token retry", "async session handling", "tokio spawn session"], "state": 2, "file_id": 315, "knowledge_revision": 1034, "git_revision": "046761b9656aa3448e0e16f1a3a9c084965a6b28", "ctags": [{"_type": "tag", "name": "LOCAL_TEST_ID", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    static LOCAL_TEST_ID: AtomicU64 = AtomicU64::new(0);$/", "language": "Rust", "kind": "variable", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "handle_first_session_load", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^fn handle_first_session_load(distributor_state: DistributorState, session: AccountSession) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState, session: AccountSession)"}, {"_type": "tag", "name": "handle_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^pub async fn handle_session(distributor_state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState)"}, {"_type": "tag", "name": "handle_token_update", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn handle_token_update(distributor_state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState)"}, {"_type": "tag", "name": "increment", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    fn increment() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "no_token_on_startup", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn no_token_on_startup() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "reset", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    fn reset() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "setup_session_listener", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn setup_session_listener(distributor_state: &DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: &DistributorState)"}, {"_type": "tag", "name": "test_already_activated_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn test_already_activated_session() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "tests", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^pub mod tests {$/", "language": "Rust", "kind": "module"}, {"_type": "tag", "name": "token_available_check_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn token_available_check_session(distributor_state: DistributorState) -> Result<(), u64> {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState) -> Result<(), u64>"}, {"_type": "tag", "name": "token_available_check_session_back_off", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn token_available_check_session_back_off() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}], "hash": "6684a4938b1998a2a286db618cfb7a4f", "format-version": 4, "code-base-name": "app-gateway2", "filename": "Supporting_Files/ripple-eos/src/manager/session_manager.rs", "fields": [{"name": "static LOCAL_TEST_ID: AtomicU64 = AtomicU64::new(0);", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "revision_history": [{"1034": "046761b9656aa3448e0e16f1a3a9c084965a6b28"}]}