{"is_source_file": true, "format": "Rust", "description": "This Rust source file implements session management logic for a service, including setup of session listeners, token handling, and retry/backoff mechanisms for session acquisition.", "external_files": ["extn::thunder::events::comcast_thunder_event_handlers::SessionTokenChangeHandler", "extn::thunder::thunder_session::ThunderSessionService", "state::distributor_state::DistributorState", "log", "thunder_ripple_sdk::client::device_operator::{DeviceOperator, DeviceResponseMessage, DeviceSubscribeRequest}", "thunder_ripple_sdk::events::thunder_event_processor::ThunderEventHandlerProvider", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession"], "external_methods": ["SessionTokenChangeHandler::event_name", "SessionTokenChangeHandler::module", "ThunderSessionService::get_account_session", "ThunderSessionService::get_sat_token", "ThunderSessionService::get_thunder", "distributor_state.get_thunder", "distributor_state.get_account_session", "distributor_state.update_account_session", "distributor_state.handle_first_account_session_update", "distributor_state.update_token", "tokio::sync::mpsc::channel", "tokio::spawn", "tokio::time::sleep", "Duration::from_millis", "handle_token_update", "setup_session_listener"], "published": [], "classes": [], "methods": [{"name": "setup_session_listener(distributor_state: &DistributorState)", "description": "Sets up a listener for session token change events, subscribes to the corresponding event, and spawns a task to handle incoming events and session state updates.", "scope": "", "scopeKind": ""}, {"name": "token_available_check_session(distributor_state: DistributorState) -> Result<(), u64>", "description": "Performs an exponential backoff mechanism to wait until an account session becomes available, retrying subscription requests with increasing delays up to a maximum number of retries.", "scope": "", "scopeKind": ""}, {"name": "handle_session(distributor_state: DistributorState)", "description": "Initializes session handling by setting up session listeners and attempting to fetch the current account session.", "scope": "", "scopeKind": ""}, {"name": "handle_first_session_load(distributor_state: DistributorState, session: AccountSession)", "description": "Updates the distributor state with a new session and spawns a task for further handling.", "scope": "", "scopeKind": ""}, {"name": "handle_token_update(distributor_state: DistributorState)", "description": "Fetches the current Session Access Token and updates the distributor state if the token is non-empty.", "scope": "", "scopeKind": ""}, {"name": "increment()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "no_token_on_startup()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "reset()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "test_already_activated_session()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}, {"name": "token_available_check_session_back_off()", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "calls": ["client.subscribe", "distributor_state.get_thunder", "distributor_state.get_account_session", "distributor_state.update_account_session", "distributor_state.handle_first_account_session_update", "ThunderSessionService::get_account_session", "ThunderSessionService::get_sat_token", "tokio::spawn", "tokio::time::sleep", "Duration::from_millis"], "search-terms": ["session listener", "session token change", "exponential backoff", "Thundersession", "session management", "token retrieval", "Rust async"], "state": 2, "file_id": 2609, "knowledge_revision": 5187, "git_revision": "0f87a35b32215bc8547fb583d6c84bd51f603f69", "ctags": [{"_type": "tag", "name": "LOCAL_TEST_ID", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    static LOCAL_TEST_ID: AtomicU64 = AtomicU64::new(0);$/", "language": "Rust", "kind": "variable", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "handle_first_session_load", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^fn handle_first_session_load(distributor_state: DistributorState, session: AccountSession) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState, session: AccountSession)"}, {"_type": "tag", "name": "handle_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^pub async fn handle_session(distributor_state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState)"}, {"_type": "tag", "name": "handle_token_update", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn handle_token_update(distributor_state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState)"}, {"_type": "tag", "name": "increment", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    fn increment() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "no_token_on_startup", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn no_token_on_startup() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "reset", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    fn reset() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "setup_session_listener", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn setup_session_listener(distributor_state: &DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: &DistributorState)"}, {"_type": "tag", "name": "test_already_activated_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn test_already_activated_session() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}, {"_type": "tag", "name": "tests", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^pub mod tests {$/", "language": "Rust", "kind": "module"}, {"_type": "tag", "name": "token_available_check_session", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^async fn token_available_check_session(distributor_state: DistributorState) -> Result<(), u64> {$/", "language": "Rust", "kind": "function", "signature": "(distributor_state: DistributorState) -> Result<(), u64>"}, {"_type": "tag", "name": "token_available_check_session_back_off", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/manager/session_manager.rs", "pattern": "/^    async fn token_available_check_session_back_off() {$/", "language": "Rust", "kind": "function", "signature": "()", "scope": "tests", "scopeKind": "module"}], "hash": "6684a4938b1998a2a286db618cfb7a4f", "format-version": 4, "code-base-name": "app-gateway2", "filename": "Supporting_Files/ripple-eos/src/manager/session_manager.rs", "fields": [{"name": "static LOCAL_TEST_ID: AtomicU64 = AtomicU64::new(0);", "scope": "tests", "scopeKind": "module", "description": "unavailable"}], "revision_history": [{"5187": "0f87a35b32215bc8547fb583d6c84bd51f603f69"}]}