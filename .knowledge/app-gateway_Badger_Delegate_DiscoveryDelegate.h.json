{"is_source_file": true, "format": "C++ header", "description": "This file defines the DiscoveryDelegate class within the WPEFramework namespace, which provides an interface for communicating with a remote discovery service via RPC. It includes methods for media event handling, content access, watching media, sign-in/sign-out operations, and entitlement account linking, utilizing JSON objects for payloads and responses. The class interacts with external utilities and logging, and manages date normalization for JSON data.", "external_files": ["DelegateUtils.h", "UtilsLogging.h"], "external_methods": ["DelegateUtils::AcquireLink"], "published": ["MediaEventAccountLink", "ContentAccess", "WatchNext", "Watched", "SignIn", "SignOut", "EntitlementsAccountLink"], "classes": [{"name": "DiscoveryDelegate", "description": "A class that facilitates communication with the FbDiscovery service for handling media events, content access, and user sign-in/sign-out operations via JSON-based RPC calls, encapsulating complex payload normalization and response handling."}], "methods": [{"name": "uint32_t MediaEventAccountLink(const std::string & appId,const std::string & payload,std::string & result)", "description": "Handles media event notifications, routing them appropriately to the discovery service, determining whether to invoke 'watchNext' or 'watched' RPCs based on the 'completed' status within the event payload.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "uint32_t ContentAccess(const std::string & appId,const std::string & idsPayload,std::string & result)", "description": "Normalizes entitlement and availability data within the provided payload and requests content access authorization from the discovery service.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "uint32_t WatchNext(const std::string & appId,const std::string & contentId,std::string & result)", "description": "Requests to the discovery service to mark content as 'watched next' based on the content ID.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "uint32_t Watched(const std::string & appId,const std::string & entityId,const double progress,const bool completed,const std::string & watchedOn,std::string & result)", "description": "Reports that a user has watched a content, along with progress and timestamps.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "uint32_t SignIn(const std::string & appId,const std::string & entitlements,bool & success)", "description": "Initiates a sign-in process with entitlement data and determines success based on service response.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "uint32_t SignOut(const std::string & appId,bool & success)", "description": "Initiates a sign-out process for the given appID and reports success.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "uint32_t EntitlementsAccountLink(const std::string & appId,const std::string & payload,std::string & result)", "description": "Handles account linkage actions such as sign-in or sign-out based on the 'type' and 'action' fields within the payload.", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"name": "DiscoveryDelegate(PluginHost::IShell * shell)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "std::string FormatIso8601FromMillis(uint64_t ms)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "void NormalizeDateField(JsonObject & obj,const char * oldKey,const char * newKey)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "bool TryEpochVariantToMillis(const Core::JSON::Variant & v,uint64_t & outMillis)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class", "description": "unavailable"}], "calls": ["DelegateUtils::AcquireLink", "link->Invoke<JsonObject, JsonObject>(_T(\"watchNext\"), ...)", "link->Invoke<JsonObject, JsonObject>(_T(\"watched\"), ...)", "link->Invoke<JsonObject, JsonObject>(_T(\"contentAccess\"), ...)", "link->Invoke<JsonObject, JsonObject>(_T(\"signIn\"), ...)", "link->Invoke<JsonObject, JsonObject>(_T(\"signOut\"), ...)"], "search-terms": ["DiscoveryDelegate", "MediaEventAccountLink", "ContentAccess", "WatchNext", "Watched", "EntitlementsAccountLink", "normalize dates", "RPC interaction", "JSON payload handling", "signIn signOut"], "state": 2, "file_id": 6439, "knowledge_revision": 16315, "git_revision": "a596ef4cfdaf99ceb7e7faaccfe4b81c2b512ea5", "revision_history": [{"12793": "f28018468ba067a40f416649bf901f0bc860aa4c"}, {"12804": "f28018468ba067a40f416649bf901f0bc860aa4c"}, {"13475": "c0bd146f4f227549be1a67cfc787928cdf3d1663"}, {"16292": "64a8452c07c2adce9dee86e11a8117b075293172"}, {"16315": "a596ef4cfdaf99ceb7e7faaccfe4b81c2b512ea5"}], "ctags": [{"_type": "tag", "name": "ContentAccess", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t ContentAccess(const std::string& appId, const std::string& idsPayload, std::st/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,const std::string & idsPayload,std::string & result)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "DiscoveryDelegate", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         DiscoveryDelegate(PluginHost::IShell* shell) : _shell(shell) { LOGDBG(\"DiscoveryDelegat/", "language": "C++", "kind": "function", "signature": "(PluginHost::IShell * shell)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "DiscoveryDelegate", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^     class DiscoveryDelegate {$/", "language": "C++", "kind": "class", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "EntitlementsAccountLink", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t EntitlementsAccountLink(const std::string& appId, const std::string& payload, /", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,const std::string & payload,std::string & result)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "FB_DISCOVERY_CALLSIGN", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^ #define FB_DISCOVERY_CALLSIGN /", "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "FormatIso8601FromMillis", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         static std::string FormatIso8601FromMillis(uint64_t ms) {$/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(uint64_t ms)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "MediaEventAccountLink", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t MediaEventAccountLink(const std::string& appId, const std::string& payload, st/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,const std::string & payload,std::string & result)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "NormalizeDateField", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         static void NormalizeDateField(JsonObject& obj, const char* oldKey, const char* newKey)/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(JsonObject & obj,const char * oldKey,const char * newKey)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "SignIn", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t SignIn(const std::string& appId, const std::string& entitlements, bool& succes/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,const std::string & entitlements,bool & success)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "SignOut", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t SignOut(const std::string& appId, bool& success) {$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,bool & success)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "TryEpochVariantToMillis", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         static bool TryEpochVariantToMillis(const Core::JSON::Variant& v, uint64_t& outMillis) /", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(const Core::JSON::Variant & v,uint64_t & outMillis)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "Type", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^             using Type = Core::JSON::Variant::type;$/", "language": "C++", "typeref": "typename:Core::JSON::Variant::type", "kind": "typedef", "scope": "WPEFramework::DiscoveryDelegate::TryEpochVariantToMillis", "scopeKind": "function"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^ namespace WPEFramework {$/", "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "WatchNext", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t WatchNext(const std::string& appId, const std::string& contentId, std::string&/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,const std::string & contentId,std::string & result)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "Watched", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         uint32_t Watched(const std::string& appId, const std::string& entityId, const double pr/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const std::string & appId,const std::string & entityId,const double progress,const bool completed,const std::string & watchedOn,std::string & result)", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "_shell", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/DiscoveryDelegate.h", "pattern": "/^         PluginHost::IShell* _shell;$/", "language": "C++", "typeref": "typename:PluginHost::IShell *", "kind": "member", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class"}], "hash": "f96bc4778cdcb4a4a7de6eccf672212e", "format-version": 4, "code-base-name": "app-gateway2", "filename": "app-gateway/Badger/Delegate/DiscoveryDelegate.h", "fields": [{"name": "PluginHost::IShell * _shell", "scope": "WPEFramework::DiscoveryDelegate", "scopeKind": "class", "description": "unavailable"}]}