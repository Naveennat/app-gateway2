{"is_source_file": true, "format": "C++ header", "description": "This file defines the MetricsDelegate class, which is responsible for sending various metrics and event data to an analytics system via a bridge interface. It provides methods for handling user actions, app actions, page views, errors, and other metrics, formatting the data according to a schema, and dispatching it through the IAnalytics interface. The class is header-only and relies on a shell interface to access the analytics plugin to send events.", "external_files": ["<core/JSON.h>", "<plugins/plugins.h>", "<interfaces/IAnalytics.h>", "UtilsCallsign.h", "UtilsLogging.h", "StringUtils.h"], "external_methods": ["WPEFramework::Exchange::IAnalytics::SendEvent", "Core::CriticalSection", "Core::JSON::Variant", "Core::JSON::String", "Core::hresult", "Core::ERROR_BAD_REQUEST", "Core::ERROR_UNAVAILABLE", "Core::ERROR_NONE"], "published": ["MetricsDelegate"], "classes": [{"name": "MetricsDelegate", "description": "A class that facilitates sending structured metrics to an analytics system by formatting events and managing communication with the Analytics plugin."}], "methods": [{"name": "Core::hresult MetricsHandler(const Core::OptionalType<std::string> & segment,const std::vector<ParamKV> & args) const", "description": "Handles general metrics events with optional segment and appId, building event payloads accordingly and dispatching via SendViaAnalytics.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult LaunchCompleted(const std::vector<ParamKV> & args) const", "description": "Reports a launch completed event, optionally with appId.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult UserAction(const std::string & action,const std::vector<ParamKV> & args) const", "description": "Sends a user action event with category 'user' and specified action, with optional appId.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult AppAction(const std::string & action,const std::vector<ParamKV> & args) const", "description": "Sends an app action event with category 'app' and specified action, with optional appId.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult PageView(const std::string & page,const std::vector<ParamKV> & args) const", "description": "Reports a page view event with specified page id and optional appId.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult UserError(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args) const", "description": "Reports a user error event with message, visibility, code, and optional appId.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult Error(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args) const", "description": "Reports an application error event with message, visibility, code, and optional appId.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult SendViaAnalytics(const std::string & eventName,const JsonObject & eventPayload) const", "description": "Internal helper to send the assembled event payload via the IAnalytics interface.", "scope": "MetricsDelegate", "scopeKind": "class"}, {"name": "Core::hresult AppAction(const std::string & action,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "void ArgsToParametersObject(const std::vector<ParamKV> & src,JsonObject & out)", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::hresult Error(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::hresult LaunchCompleted(const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "MetricsDelegate(PluginHost::IShell * shell)", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::hresult MetricsHandler(const Core::OptionalType<std::string> & segment,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::hresult PageView(const std::string & page,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "ParamKV(const std::string & n,const Core::JSON::Variant & v)", "scope": "MetricsDelegate::ParamKV", "scopeKind": "struct", "description": "unavailable"}, {"name": "Core::hresult SendViaAnalytics(const std::string & eventName,const JsonObject & eventPayload,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::hresult UserAction(const std::string & action,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::hresult UserError(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "bool ValidateActionType(const std::string & s)", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "JsonValue VariantToJsonValue(const Core::JSON::Variant & v)", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}], "calls": ["SendViaAnalytics", "ArgsToParametersObject", "VariantToJsonValue", "logerr", "QueryInterfaceByCallsign"], "search-terms": ["MetricsDelegate", "Analytics", "send event", "AppAction", "UserAction", "PageView", "Error", "UserError", "launch completed", "metrics handling"], "state": 2, "file_id": 5742, "knowledge_revision": 11375, "git_revision": "", "ctags": [{"_type": "tag", "name": "AppAction", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult AppAction(const std::string& action, const std::vector<ParamKV>& args) const {$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & action,const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "AppAction", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult AppAction(const std::string& action, const std::vector<ParamKV>& args, const s/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & action,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "ArgsToParametersObject", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    static inline void ArgsToParametersObject(const std::vector<ParamKV>& src, JsonObject& out) /", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const std::vector<ParamKV> & src,JsonObject & out)", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "Error", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult Error(const std::string& message, bool visible, const std::string& code,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "Error", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult Error(const std::string& message, bool visible, const std::string& code,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "LaunchCompleted", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult LaunchCompleted(const std::vector<ParamKV>& args) const {$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "LaunchCompleted", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult LaunchCompleted(const std::vector<ParamKV>& args, const std::string& appId) co/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "MetricsDelegate", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    explicit MetricsDelegate(PluginHost::IShell* shell)$/", "language": "C++", "kind": "function", "signature": "(PluginHost::IShell * shell)", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "MetricsDelegate", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^class MetricsDelegate {$/", "language": "C++", "kind": "class"}, {"_type": "tag", "name": "MetricsHandler", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult MetricsHandler(const Core::OptionalType<std::string>& segment,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const Core::OptionalType<std::string> & segment,const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "MetricsHandler", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult MetricsHandler(const Core::OptionalType<std::string>& segment,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const Core::OptionalType<std::string> & segment,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "PageView", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult PageView(const std::string& page, const std::vector<ParamKV>& args) const {$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & page,const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "PageView", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult PageView(const std::string& page, const std::vector<ParamKV>& args, const std:/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & page,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "ParamKV", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^        ParamKV(const std::string& n, const Core::JSON::Variant& v) : name(n), value(v) {}$/", "language": "C++", "kind": "function", "signature": "(const std::string & n,const Core::JSON::Variant & v)", "scope": "MetricsDelegate::ParamKV", "scopeKind": "struct"}, {"_type": "tag", "name": "ParamKV", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    struct ParamKV {$/", "language": "C++", "kind": "struct", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "SendViaAnalytics", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult SendViaAnalytics(const std::string& eventName, const JsonObject& eventPayload)/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & eventName,const JsonObject & eventPayload) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "SendViaAnalytics", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult SendViaAnalytics(const std::string& eventName, const JsonObject& eventPayload,/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & eventName,const JsonObject & eventPayload,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "UserAction", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult UserAction(const std::string& action, const std::vector<ParamKV>& args) const /", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & action,const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "UserAction", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult UserAction(const std::string& action, const std::vector<ParamKV>& args, const /", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & action,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "UserError", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult UserError(const std::string& message, bool visible, const std::string& code,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "UserError", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    Core::hresult UserError(const std::string& message, bool visible, const std::string& code,$/", "language": "C++", "typeref": "typename:Core::hresult", "kind": "function", "signature": "(const std::string & message,bool visible,const std::string & code,const std::vector<ParamKV> & args,const std::string & appId) const", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "ValidateActionType", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    static inline bool ValidateActionType(const std::string& s) {$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(const std::string & s)", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "VariantToJsonValue", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    static inline JsonValue VariantToJsonValue(const Core::JSON::Variant& v) {$/", "language": "C++", "typeref": "typename:JsonValue", "kind": "function", "signature": "(const Core::JSON::Variant & v)", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "_shell", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    PluginHost::IShell* _shell;$/", "language": "C++", "typeref": "typename:PluginHost::IShell *", "kind": "member", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "mAdminLock", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^    mutable Core::CriticalSection mAdminLock;$/", "language": "C++", "typeref": "typename:Core::CriticalSection", "kind": "member", "scope": "MetricsDelegate", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^        std::string name;$/", "language": "C++", "typeref": "typename:std::string", "kind": "member", "scope": "MetricsDelegate::ParamKV", "scopeKind": "struct"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Badger/Delegate/MetricsDelegate.h", "pattern": "/^        Core::JSON::Variant value;$/", "language": "C++", "typeref": "typename:Core::JSON::Variant", "kind": "member", "scope": "MetricsDelegate::ParamKV", "scopeKind": "struct"}], "hash": "896feba0134b951f69bf6864d071e5fc", "format-version": 4, "code-base-name": "app-gateway2", "filename": "app-gateway/Badger/Delegate/MetricsDelegate.h", "fields": [{"name": "PluginHost::IShell * _shell", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::CriticalSection mAdminLock", "scope": "MetricsDelegate", "scopeKind": "class", "description": "unavailable"}, {"name": "std::string name", "scope": "MetricsDelegate::ParamKV", "scopeKind": "struct", "description": "unavailable"}, {"name": "Core::JSON::Variant value", "scope": "MetricsDelegate::ParamKV", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"11375": ""}]}