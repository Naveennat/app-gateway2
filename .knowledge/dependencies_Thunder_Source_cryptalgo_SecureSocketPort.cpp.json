{"is_source_file": true, "format": "C++", "description": "This file implements a SecureSocketPort class that manages SSL/TLS connections using OpenSSL. It includes initialization, certificate handling, handshake validation, read/write operations, and connection management functionalities.", "external_files": ["SecureSocketPort.h", "openssl/ssl.h", "openssl/x509v3.h"], "external_methods": ["SSL_library_init", "OpenSSL_add_all_algorithms", "SSL_load_error_strings", "SSL_CTX_new", "SSL_new", "SSL_set_fd", "SSL_CTX_set_options", "SSL_CTX_set_default_verify_paths", "SSL_read", "SSL_write", "SSL_shutdown", "SSL_get_peer_certificate", "SSL_get_error", "SSL_do_handshake", "X509_free", "X509_get_issuer_name", "X509_get_subject_name", "X509_get0_notBefore", "X509_get0_notAfter", "X509_check_host", "X509_verify_cert_error_string", "X509_NAME_oneline"], "published": ["SecureSocketPort::Certificate"], "classes": [{"name": "OpenSSL", "description": "A helper class for initializing OpenSSL library once."}, {"name": "SecureSocketPort::Certificate", "description": "Represents an X509 certificate and provides methods to access issuer, subject, validity period, hostname verification, and verification status."}, {"name": "SecureSocketPort::Handler", "description": "Handles SSL connection lifecycle, including initialization, reading, writing, handshake validation, and cleanup."}], "methods": [{"name": "Core::Time ASN1_ToTime(const ASN1_TIME * input)", "description": "Converts ASN1_TIME structure to Core::Time object.", "scope": "WPEFramework::Crypto", "scopeKind": "namespace"}, {"name": "SecureSocketPort::Certificate::Issuer", "description": "Returns the issuer name of the certificate as a string."}, {"name": "SecureSocketPort::Certificate::Subject", "description": "Returns the subject name of the certificate as a string."}, {"name": "SecureSocketPort::Certificate::ValidFrom", "description": "Returns the Not Before validity time."}, {"name": "SecureSocketPort::Certificate::ValidTill", "description": "Returns the Not After (expiry) time."}, {"name": "SecureSocketPort::Certificate::ValidHostname", "description": "Checks if the certificate is valid for the expected hostname."}, {"name": "SecureSocketPort::Certificate::Verify", "description": "Verifies the certificate against current trust store and populates errorMsg if verification fails."}, {"name": "SecureSocketPort::Handler::~Handler", "description": "Destructor that frees SSL and SSL_CTX resources."}, {"name": "SecureSocketPort::Handler::Initialize", "description": "Initializes SSL context and socket; loads default verify paths."}, {"name": "SecureSocketPort::Handler::Read", "description": "Performs SSL read operation."}, {"name": "SecureSocketPort::Handler::Write", "description": "Performs SSL write operation."}, {"name": "SecureSocketPort::Handler::Open", "description": "Opens the socket connection."}, {"name": "SecureSocketPort::Handler::Close", "description": "Closes the SSL connection and socket."}, {"name": "SecureSocketPort::Handler::ValidateHandShake", "description": "Validates server certificate, hostname, and updates connection state."}, {"name": "SecureSocketPort::Handler::Update", "description": "Manages handshake and connection state updates during SSL negotiation."}, {"name": "uint32_t Close(const uint32_t waitTime)", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "uint32_t Initialize()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "string Issuer() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class", "description": "unavailable"}, {"name": "uint32_t Open(const uint32_t waitTime)", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "OpenSSL()", "scope": "__anon85a2c8320111::OpenSSL", "scopeKind": "class", "description": "unavailable"}, {"name": "int32_t Read(uint8_t buffer[],const uint16_t length) const", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "string Subject() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class", "description": "unavailable"}, {"name": "void Update()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::Time ValidFrom() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class", "description": "unavailable"}, {"name": "bool ValidHostname(const string & expectedHostname) const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class", "description": "unavailable"}, {"name": "Core::Time ValidTill() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class", "description": "unavailable"}, {"name": "void ValidateHandShake()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "bool Verify(string & errorMsg) const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class", "description": "unavailable"}, {"name": "int32_t Write(const uint8_t buffer[],const uint16_t length)", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "~Handler()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class", "description": "unavailable"}, {"name": "~OpenSSL()", "scope": "__anon85a2c8320111::OpenSSL", "scopeKind": "class", "description": "unavailable"}], "calls": ["SSL_library_init", "OpenSSL_add_all_algorithms", "SSL_load_error_strings", "SSL_CTX_new", "SSL_new", "SSL_set_fd", "SSL_CTX_set_options", "SSL_CTX_set_default_verify_paths", "SSL_read", "SSL_write", "SSL_shutdown", "SSL_get_peer_certificate", "SSL_get_error", "SSL_do_handshake", "X509_free", "X509_get_issuer_name", "X509_get_subject_name", "X509_get0_notBefore", "X509_get0_notAfter", "X509_check_host", "X509_verify_cert_error_string", "X509_NAME_oneline", "Core::Time::Time", "Core::Time::operator+"], "search-terms": ["SecureSocketPort", "SSL", "OpenSSL", "TLS", "X509", "certificate", "handshake", "SSL_CTX", "validation", "hostname verification", "TLS connection"], "state": 2, "file_id": 457, "knowledge_revision": 1586, "git_revision": "", "ctags": [{"_type": "tag", "name": "ASN1_ToTime", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^    static Core::Time ASN1_ToTime(const ASN1_TIME* input)$/", "file": true, "language": "C++", "typeref": "typename:Core::Time", "kind": "function", "signature": "(const ASN1_TIME * input)", "scope": "WPEFramework::Crypto", "scopeKind": "namespace"}, {"_type": "tag", "name": "Close", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^uint32_t SecureSocketPort::Handler::Close(const uint32_t waitTime) {$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const uint32_t waitTime)", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "Crypto", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^namespace Crypto {$/", "file": true, "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "Initialize", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^uint32_t SecureSocketPort::Handler::Initialize() {$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "Issuer", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^string SecureSocketPort::Certificate::Issuer() const {$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class"}, {"_type": "tag", "name": "Open", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^uint32_t SecureSocketPort::Handler::Open(const uint32_t waitTime) {$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const uint32_t waitTime)", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "OpenSSL", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^        OpenSSL()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "__anon85a2c8320111::OpenSSL", "scopeKind": "class"}, {"_type": "tag", "name": "OpenSSL", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^    class OpenSSL {$/", "file": true, "language": "C++", "kind": "class", "scope": "__anon85a2c8320111", "scopeKind": "namespace"}, {"_type": "tag", "name": "Read", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^int32_t SecureSocketPort::Handler::Read(uint8_t buffer[], const uint16_t length) const {$/", "language": "C++", "typeref": "typename:int32_t", "kind": "function", "signature": "(uint8_t buffer[],const uint16_t length) const", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "Subject", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^string SecureSocketPort::Certificate::Subject() const {$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class"}, {"_type": "tag", "name": "Update", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^void SecureSocketPort::Handler::Update() {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "ValidFrom", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^Core::Time SecureSocketPort::Certificate::ValidFrom() const {$/", "language": "C++", "typeref": "typename:Core::Time", "kind": "function", "signature": "() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class"}, {"_type": "tag", "name": "ValidHostname", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^bool SecureSocketPort::Certificate::ValidHostname(const string& expectedHostname) const {$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(const string & expectedHostname) const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class"}, {"_type": "tag", "name": "ValidTill", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^Core::Time SecureSocketPort::Certificate::ValidTill() const {$/", "language": "C++", "typeref": "typename:Core::Time", "kind": "function", "signature": "() const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class"}, {"_type": "tag", "name": "ValidateHandShake", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^void SecureSocketPort::Handler::ValidateHandShake() {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "Verify", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^bool SecureSocketPort::Certificate::Verify(string& errorMsg) const {$/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(string & errorMsg) const", "scope": "WPEFramework::Crypto::SecureSocketPort::Certificate", "scopeKind": "class"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^namespace WPEFramework {$/", "file": true, "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "Write", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^int32_t SecureSocketPort::Handler::Write(const uint8_t buffer[], const uint16_t length) {$/", "language": "C++", "typeref": "typename:int32_t", "kind": "function", "signature": "(const uint8_t buffer[],const uint16_t length)", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "__anon85a2c8320111", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^namespace {$/", "file": true, "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "_initialization", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^    static OpenSSL _initialization;$/", "file": true, "language": "C++", "typeref": "typename:OpenSSL", "kind": "variable", "scope": "__anon85a2c8320111", "scopeKind": "namespace"}, {"_type": "tag", "name": "~Handler", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^SecureSocketPort::Handler::~Handler() {$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Crypto::SecureSocketPort::Handler", "scopeKind": "class"}, {"_type": "tag", "name": "~OpenSSL", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "pattern": "/^        ~OpenSSL()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "__anon85a2c8320111::OpenSSL", "scopeKind": "class"}], "hash": "da15b643196317d44702eeb9509a41dd", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/Thunder/Source/cryptalgo/SecureSocketPort.cpp", "fields": [{"name": "OpenSSL _initialization", "scope": "__anon85a2c8320111", "scopeKind": "namespace", "description": "unavailable"}], "revision_history": [{"1586": ""}]}