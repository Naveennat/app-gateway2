{"is_source_file": true, "format": "C++", "description": "This file implements the EssClient class which manages privacy and consent settings by making HTTP requests (GET and PUT) to a specified API endpoint. It includes functions for retrieving and setting privacy settings, privacy strings, exclusion policies, and parsing JSON responses. It also handles authorization token refresh and error handling. The file interacts with external components for device info, telemetry, and JSON parsing.", "external_files": ["EssClient.h", "UtilsTelemetry.h", "<curl/curl.h>", "<ctime>"], "external_methods": ["Core::ERROR_NONE", "Core::ERROR_UNAVAILABLE", "Core::ERROR_NOT_SUPPORTED", "Core::ERROR_UNREACHABLE_NETWORK", "Core::ERROR_GENERAL", "mDeviceInfoPtr->GetPartnerId", "mDeviceInfoPtr->GetAccountId", "mDeviceInfoPtr->GetServiceAccessToken", "LOGERR", "LOGINFO", "Utils::Telemetry::SendError", "JsonObject::FromString", "JsonObject::HasLabel", "JsonObject::Object", "JsonObject::String", "JsonObject::Boolean", "JsonObject::Content", "JsonObject::Variants", "JsonObject::Array", "JsonObject::ToString"], "published": ["EssClient::GetConsentString", "EssClient::GetPrivacySetting", "EssClient::GetPrivacySettings", "EssClient::SetPrivacySettings", "EssClient::GetExclusionPolicies"], "classes": [{"name": "EssClient", "description": "A class responsible for managing privacy and consent settings via API calls, including retrieving and updating privacy strings, privacy settings, and exclusion policies, with JSON parsing and HTTP handling."}], "methods": [{"name": "uint32_t GetConsentString(const string & adUsecase,EssConsentString & result)", "description": "Fetches a consent string from the server based on ad use case, parsing the response to fill a consent string structure.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t GetPrivacySetting(const string & settingName,EssPrivacySettingData & settingData)", "description": "Retrieves a specific privacy setting from the server.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t GetPrivacySettings(EssPrivacySettings & settings)", "description": "Retrieves all privacy settings.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t SetPrivacySettings(const EssPrivacySettings & settings)", "description": "Updates privacy settings on the server.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t GetExclusionPolicies(EssExclusionPolicies & policies)", "description": "Fetches exclusion policies from the server.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "long HttpGet(const string & url,const string & authToken,std::string & response,std::string & header)", "description": "Performs an HTTP GET request with curl, including authorization headers.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "long HttpPut(const string & url,const string & authToken,const string & data,std::string & response)", "description": "Performs an HTTP PUT request with curl, including authorization headers.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t ProcessGet(const string & url,std::string & response,std::string & header)", "description": "Handles token refresh and calls HttpGet, interpreting HTTP status codes.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t ProcessPut(const string & url,const string & data)", "description": "Handles token refresh and calls HttpPut, interpreting HTTP status codes.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t StringToConsentString(const string & str,const string & header,EssConsentString & consentString)", "description": "Parses the JSON response to populate a consent string object, extracting values and expiry info.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t StringToPrivacySettings(const string & str,EssPrivacySettings & settings)", "description": "Parses a JSON string into the privacy settings object.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t StringToPrivacySetting(const string & str,const string & settingName,EssPrivacySettingData & settingData)", "description": "Parses a JSON string for a specific privacy setting.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t ParsePrivacySettingJsonObject(const JsonObject & json,EssPrivacySettingData & settingData)", "description": "Extracts privacy setting details from a JSON object.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "void PrivacySettingsToString(const EssPrivacySettings & setting,string & str)", "description": "Serializes privacy settings into JSON string.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "uint32_t StringToExclusionPolicies(const string & str,EssExclusionPolicies & policies)", "description": "Parses JSON string into exclusion policies.", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"name": "size_t CurlWriteCallback(void * contents,size_t size,size_t nmemb,void * userp)", "scope": "WPEFramework::Plugin", "scopeKind": "namespace", "description": "unavailable"}, {"name": "EssClient(const string & url,const string & clientId,DeviceInfoPtr deviceInfoPtr)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class", "description": "unavailable"}, {"name": "__anon980209750102(const JsonObject &json, const char *label, EssExclusionPolicyData &policyData)", "scope": "WPEFramework::Plugin::EssClient::StringToExclusionPolicies", "scopeKind": "function", "description": "unavailable"}], "calls": ["mDeviceInfoPtr->GetPartnerId", "mDeviceInfoPtr->GetAccountId", "mDeviceInfoPtr->GetServiceAccessToken", "curl_easy_init", "curl_easy_setopt", "curl_easy_perform", "curl_easy_getinfo", "curl_slist_append", "curl_slist_free_all", "curl_easy_cleanup", "JsonObject::FromString", "JsonObject::HasLabel", "JsonObject::Object", "JsonObject::String", "JsonObject::Boolean", "JsonObject::Content", "JsonObject::Variants", "JsonObject::Array", "JsonObject::ToString", "Utils::Telemetry::SendError", "LOGERR", "LOGINFO"], "search-terms": ["EssClient", "privacyStrings", "privacySettings", "ExclusionPolicies", "GetConsentString", "GetPrivacySetting", "SetPrivacySettings", "ProcessGet", "ProcessPut", "json parsing", "curl HTTP", "access token refresh", "privacy API"], "state": 2, "file_id": 3965, "knowledge_revision": 8235, "git_revision": "c6407f62c45335b3529c145325fdcfefd3215700", "ctags": [{"_type": "tag", "name": "CURL_TIMEOUT_SEC", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^#define CURL_TIMEOUT_SEC /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "CurlWriteCallback", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        static size_t CurlWriteCallback(void *contents, size_t size, size_t nmemb, void *userp)$/", "file": true, "language": "C++", "typeref": "typename:size_t", "kind": "function", "signature": "(void * contents,size_t size,size_t nmemb,void * userp)", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "EssClient", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        EssClient::EssClient(const string &url, const string &clientId, DeviceInfoPtr deviceInfo/", "language": "C++", "kind": "function", "signature": "(const string & url,const string & clientId,DeviceInfoPtr deviceInfoPtr)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "GetConsentString", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::GetConsentString(const string &adUsecase, EssConsentString &result)$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & adUsecase,EssConsentString & result)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "GetExclusionPolicies", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::GetExclusionPolicies(EssExclusionPolicies &policies)$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(EssExclusionPolicies & policies)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "GetPrivacySetting", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::GetPrivacySetting(const string &settingName, EssPrivacySettingData &/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & settingName,EssPrivacySettingData & settingData)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "GetPrivacySettings", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::GetPrivacySettings(EssPrivacySettings &settings)$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(EssPrivacySettings & settings)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "HttpGet", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        long EssClient::HttpGet(const string &url, const string &authToken, std::string &respons/", "language": "C++", "typeref": "typename:long", "kind": "function", "signature": "(const string & url,const string & authToken,std::string & response,std::string & header)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "HttpPut", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        long EssClient::HttpPut(const string &url, const string &authToken, const string &data, /", "language": "C++", "typeref": "typename:long", "kind": "function", "signature": "(const string & url,const string & authToken,const string & data,std::string & response)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "ParsePrivacySettingJsonObject", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::ParsePrivacySettingJsonObject(const JsonObject &json, EssPrivacySett/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const JsonObject & json,EssPrivacySettingData & settingData)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^    namespace Plugin$/", "file": true, "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "PrivacySettingsToString", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        void EssClient::PrivacySettingsToString(const EssPrivacySettings &setting, string &str)$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const EssPrivacySettings & setting,string & str)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "ProcessGet", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::ProcessGet(const string &url, std::string &response, std::string &he/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & url,std::string & response,std::string & header)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "ProcessPut", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::ProcessPut(const string &url, const string &data)$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & url,const string & data)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "SetPrivacySettings", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::SetPrivacySettings(const EssPrivacySettings &settings)$/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const EssPrivacySettings & settings)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "StringToConsentString", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::StringToConsentString(const string &str, const string &header, EssCo/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & str,const string & header,EssConsentString & consentString)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "StringToExclusionPolicies", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::StringToExclusionPolicies(const string &str, EssExclusionPolicies &p/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & str,EssExclusionPolicies & policies)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "StringToPrivacySetting", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::StringToPrivacySetting(const string &str, const string &settingName,/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & str,const string & settingName,EssPrivacySettingData & settingData)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "StringToPrivacySettings", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^        uint32_t EssClient::StringToPrivacySettings(const string &str, EssPrivacySettings &setti/", "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(const string & str,EssPrivacySettings & settings)", "scope": "WPEFramework::Plugin::EssClient", "scopeKind": "class"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^namespace WPEFramework$/", "file": true, "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "__anon980209750102", "path": "/home/kavia/workspace/code-generation/app-gateway2/app-gateway/Privacy/Implementation/EssClient.cpp", "pattern": "/^            {$/", "file": true, "language": "C++", "kind": "function", "signature": "(const JsonObject &json, const char *label, EssExclusionPolicyData &policyData) ", "scope": "WPEFramework::Plugin::EssClient::StringToExclusionPolicies", "scopeKind": "function"}], "hash": "f4496daa7bbaa2414afd715edf9a42ec", "format-version": 4, "code-base-name": "app-gateway2", "filename": "app-gateway/Privacy/Implementation/EssClient.cpp", "revision_history": [{"8235": "c6407f62c45335b3529c145325fdcfefd3215700"}]}