{"is_source_file": true, "format": "Rust", "description": "Source code for a Rust-based service called SyncAndMonitorService, which manages synchronization and monitoring for devices using the Thunder Ripple SDK. It includes async functions for processing state requests, starting periodic synchronization tasks, and handling module-specific sync requests. The file defines enums, structs, and async methods related to device state monitoring, privacy, and partner exclusion synchronization.", "external_files": ["crate::manager::data_governor::DataGovernance", "crate::manager::privacy_response_manager::PrivacyResponseManager", "crate::message::DpabError", "crate::state::distributor_state::DistributorState", "crate::util::cloud_linchpin_monitor::LinchpinConnectionStatus", "crate::util::cloud_sync_monitor_utils::get_sync_settings", "crate::util::{cloud_linchpin_monitor::CloudLinchpinMonitor, cloud_periodic_sync::CloudPeriodicSync, cloud_sync_monitor_utils::StateRequest, sync_settings::SyncSettings}", "thunder_ripple_sdk::ripple_sdk::api::device::device_info_request::DeviceInfoRequest", "thunder_ripple_sdk::ripple_sdk::api::distributor::distributor_privacy::PrivacyResponse", "thunder_ripple_sdk::ripple_sdk::api::manifest::device_manifest::PrivacySettingsStorageType", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession", "std::collections::{HashMap, HashSet}", "std::sync::{Arc, Once, RwLock}", "std::time::Duration", "thunder_ripple_sdk::ripple_sdk::extn::client::extn_client::ExtnClient", "thunder_ripple_sdk::ripple_sdk::log::{debug, error}", "tokio::sync::mpsc::{self, Receiver, Sender}"], "external_methods": ["DataGovernance::refresh_partner_exclusions", "PrivacyResponseManager::start", "get_sync_settings", "CloudPeriodicSync::start", "CloudPeriodicSync::sync", "CloudLinchpinMonitor::start", "CloudLinchpinMonitor::subscribe", "DistributorState::get_client", "DistributorState::get_account_session"], "published": ["SyncAndMonitorModule", "SyncAndMonitorService"], "classes": [{"name": "SyncAndMonitorModule", "description": "Enumeration representing the modules managed by the sync and monitor service, including Privacy and UserGrants."}, {"name": "SyncAndMonitorService", "description": "Primary struct managing synchronization and monitoring tasks including periodic sync and state request processing."}], "methods": [{"name": "process_state_requests( extn_client: ExtnClient, mut rx: Receiver<StateRequest>, account_session: Arc<RwLock<Option<AccountSession>>>, )", "description": "Asynchronous method that continuously processes incoming state requests from a receiver, managing listeners, topics, and connection status.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "start(state: DistributorState)", "description": "Initializes and starts the SyncAndMonitorService with the provided device state.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "new(state: &DistributorState) -> Self", "description": "Constructs a new instance of SyncAndMonitorService, setting up channels, starting periodic sync tasks, and launch the request processing loop.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "sync(&self)", "description": "Triggers synchronization processes if privacy settings storage type is configured for sync, including starting privacy response manager and partner exclusion sync.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "handle_sync_request( &self, module: SyncAndMonitorModule, callback: Option<Sender<PrivacyResponse>>, ) -> Result<(), DpabError>", "description": "Handles synchronization requests for specific modules, managing subscription to linchpin topics and periodic sync based on settings.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "sync_partner_exclusions(state: DistributorState)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["DataGovernance::refresh_partner_exclusions", "PrivacyResponseManager::start", "get_sync_settings", "CloudPeriodicSync::sync", "CloudLinchpinMonitor::subscribe", "SyncAndMonitorService::handle_sync_request"], "search-terms": ["SyncAndMonitor", "cloud_sync", "privacy_settings", "partner_exclusion", "Thuner Ripple SDK", "distributor_state", "state_requests", "async Rust"], "state": 2, "file_id": 1818, "knowledge_revision": 4409, "git_revision": "0f87a35b32215bc8547fb583d6c84bd51f603f69", "ctags": [{"_type": "tag", "name": "Privacy", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    Privacy,$/", "language": "Rust", "kind": "enumerator", "scope": "SyncAndMonitorModule", "scopeKind": "enum"}, {"_type": "tag", "name": "START_PARTNER_EXCLUSION_SYNC_THREAD", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^static START_PARTNER_EXCLUSION_SYNC_THREAD: Once = Once::new();$/", "language": "Rust", "kind": "variable"}, {"_type": "tag", "name": "SyncAndMonitorModule", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^pub enum SyncAndMonitorModule {$/", "language": "Rust", "kind": "enum"}, {"_type": "tag", "name": "SyncAndMonitorService", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^impl SyncAndMonitorService {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "SyncAndMonitorService", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^pub struct SyncAndMonitorService {$/", "language": "Rust", "kind": "struct"}, {"_type": "tag", "name": "UserGrants", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    UserGrants,$/", "language": "Rust", "kind": "enumerator", "scope": "SyncAndMonitorModule", "scopeKind": "enum"}, {"_type": "tag", "name": "cloud_linchpin_monitor", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    cloud_linchpin_monitor: CloudLinchpinMonitor,$/", "language": "Rust", "kind": "field", "scope": "SyncAndMonitorService", "scopeKind": "struct"}, {"_type": "tag", "name": "cloud_periodic_sync", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    pub cloud_periodic_sync: CloudPeriodicSync,$/", "language": "Rust", "kind": "field", "scope": "SyncAndMonitorService", "scopeKind": "struct"}, {"_type": "tag", "name": "handle_sync_request", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    async fn handle_sync_request($/", "language": "Rust", "kind": "method", "signature": "( &self, module: SyncAndMonitorModule, callback: Option<Sender<PrivacyResponse>>, ) -> Result<(), DpabError>", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "new", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    fn new(state: &DistributorState) -> Self {$/", "language": "Rust", "kind": "method", "signature": "(state: &DistributorState) -> Self", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "process_state_requests", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    pub async fn process_state_requests($/", "language": "Rust", "kind": "method", "signature": "( extn_client: ExtnClient, mut rx: Receiver<StateRequest>, account_session: Arc<RwLock<Option<AccountSession>>>, )", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    pub fn start(state: DistributorState) {$/", "language": "Rust", "kind": "method", "signature": "(state: DistributorState)", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    state: DistributorState,$/", "language": "Rust", "kind": "field", "scope": "SyncAndMonitorService", "scopeKind": "struct"}, {"_type": "tag", "name": "sync", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    fn sync(&self) {$/", "language": "Rust", "kind": "method", "signature": "(&self)", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "sync_partner_exclusions", "path": "/home/kavia/workspace/code-generation/app-gateway2/__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^async fn sync_partner_exclusions(state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(state: DistributorState)"}], "hash": "fae0055f2fdfcf0c563921745723b688", "format-version": 4, "code-base-name": "app-gateway2", "filename": "__import__/extracted/app-gateway2-cga-cmf8e7ba8d/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "fields": [{"name": "static START_PARTNER_EXCLUSION_SYNC_THREAD: Once = Once::new();", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cloud_linchpin_monitor: CloudLinchpinMonitor,", "scope": "SyncAndMonitorService", "scopeKind": "struct", "description": "unavailable"}, {"name": "pub cloud_periodic_sync: CloudPeriodicSync,", "scope": "SyncAndMonitorService", "scopeKind": "struct", "description": "unavailable"}, {"name": "state: DistributorState,", "scope": "SyncAndMonitorService", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"4409": "0f87a35b32215bc8547fb583d6c84bd51f603f69"}]}