{"is_source_file": true, "format": "C++ header file", "description": "This file defines a template class `MTlsEnabled` that provides mTLS-enabled WebSocket functionality, including TLS context setup, certificate management, and connection authentication logic.", "external_files": ["websocketpp/config/asio_client.hpp", "websocketpp/client.hpp", "../../ScopeGuard.h", "../../utils.h", "../Certificates.h"], "external_methods": ["websocketpp::lib::shared_ptr", "websocketpp::lib::asio::ssl::context", "websocketpp::transport::asio::socket::get_socket_category", "X509_verify_cert_error_string", "X509_STORE_CTX_get_error", "SSL_CTX_set_ecdh_auto"], "published": ["MTlsEnabled"], "classes": [{"name": "MTlsEnabled", "description": "A template class providing mTLS security features for WebSocket client endpoints, including TLS context configuration, certificate handling, and connection validation."}], "methods": [{"name": "void setup()", "description": "Sets up TLS initialization handler for the derived WebSocket endpoint.", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"name": "std::string addProtocolToAddress(const std::string & address)", "description": "Prefixes an address with 'wss://' to form a WebSocket Secure URL.", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"name": "void setAuthenticationState(ConnectionInitializationResult & result,websocketpp::connection_hdl handler)", "description": "Determines if a TLS connection was successfully established and updates the result accordingly.", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"name": "MTlsEnabled<Derived,Role>::WebsocketppContextPtr onTlsInit(websocketpp::connection_hdl)", "description": "Creates and configures a new SSL context for TLS, loading certificates and setting verification modes.", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"name": "bool logIfCertFailure(bool preverified,boost::asio::ssl::verify_context & verify_ctx) const", "description": "Logs details if certificate verification fails.", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"name": "void loadCertificateAuthorities(const WebsocketppContextPtr & ctx) const", "description": "Loads trusted Certificate Authority files into the SSL context.", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"name": "MTlsEnabled()", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class", "description": "unavailable"}, {"name": "__anon676a5ddc0102()", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled::onTlsInit", "scopeKind": "function", "description": "unavailable"}, {"name": "~MTlsEnabled()", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class", "description": "unavailable"}], "calls": ["std::bind", "certificates_.prepareCertFiles", "certificates_.getCertPath", "certificates_.getKeyPath", "certificates_.getCertAuthoritiesPaths", "boost::filesystem::exists", "ctx->load_verify_file"], "search-terms": ["mTLS", "websocket TLS setup", "certificate authorities", "MTlsEnabled template class", "WebSocket secure context", "certificate loading"], "state": 2, "file_id": 8423, "knowledge_revision": 17552, "git_revision": "bc95ad096bdaa0d2d554ecfc4389c78048005d56", "ctags": [{"_type": "tag", "name": "EndpointType", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^    using EndpointType = typename Role::EncryptedEndpointType;$/", "language": "C++", "typeref": "typename:Role::EncryptedEndpointType", "kind": "typedef", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "MTlsEnabled", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^MTlsEnabled<Derived, Role>::MTlsEnabled()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "MTlsEnabled", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^class MTlsEnabled$/", "language": "C++", "kind": "class", "scope": "WPEFramework::Plugin::WebSockets", "scopeKind": "namespace"}, {"_type": "tag", "name": "Plugin", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^namespace Plugin       {$/", "language": "C++", "kind": "namespace", "scope": "WPEFramework", "scopeKind": "namespace"}, {"_type": "tag", "name": "WPEFramework", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^namespace WPEFramework {$/", "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "WebSockets", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^namespace WebSockets   {$/", "language": "C++", "kind": "namespace", "scope": "WPEFramework::Plugin", "scopeKind": "namespace"}, {"_type": "tag", "name": "WebsocketppContextPtr", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^    using WebsocketppContextPtr = websocketpp::lib::shared_ptr<websocketpp::lib::asio::ssl::cont/", "language": "C++", "typeref": "typename:websocketpp::lib::shared_ptr<websocketpp::lib::asio::ssl::context>", "kind": "typedef", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "__anon676a5ddc0102", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^    ScopeGuard<std::function<void()> > guard{[this] () { certificates_.removeCertFiles(); }};$/", "file": true, "language": "C++", "kind": "function", "signature": "() ", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled::onTlsInit", "scopeKind": "function"}, {"_type": "tag", "name": "addProtocolToAddress", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^std::string MTlsEnabled<Derived, Role>::addProtocolToAddress(const std::string& address)$/", "language": "C++", "typeref": "typename:std::string", "kind": "function", "signature": "(const std::string & address)", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "certificates_", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^    const Certificates certificates_;$/", "language": "C++", "typeref": "typename:const Certificates", "kind": "member", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "loadCertificateAuthorities", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^void MTlsEnabled<Derived, Role>::loadCertificateAuthorities(const WebsocketppContextPtr& ctx) co/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const WebsocketppContextPtr & ctx) const", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "logIfCertFailure", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^bool MTlsEnabled<Derived, Role>::logIfCertFailure(bool preverified, boost::asio::ssl::verify_con/", "language": "C++", "typeref": "typename:bool", "kind": "function", "signature": "(bool preverified,boost::asio::ssl::verify_context & verify_ctx) const", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "onTlsInit", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^typename MTlsEnabled<Derived, Role>::WebsocketppContextPtr MTlsEnabled<Derived, Role>::onTlsInit/", "language": "C++", "typeref": "typename:MTlsEnabled<Derived,Role>::WebsocketppContextPtr", "kind": "function", "signature": "(websocketpp::connection_hdl)", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "setAuthenticationState", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^void MTlsEnabled<Derived, Role>::setAuthenticationState(ConnectionInitializationResult& result, /", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(ConnectionInitializationResult & result,websocketpp::connection_hdl handler)", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "setup", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^void MTlsEnabled<Derived, Role>::setup()$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}, {"_type": "tag", "name": "~MTlsEnabled", "path": "/home/kavia/workspace/code-generation/app-gateway2/helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "pattern": "/^MTlsEnabled<Derived, Role>::~MTlsEnabled()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class"}], "hash": "8099b64887426788e66264ea38e5e4b3", "format-version": 4, "code-base-name": "app-gateway2", "filename": "helpers/rdkservices-comcast/helpers/WebSockets/Encryption/MTlsEnabled.h", "fields": [{"name": "const Certificates certificates_", "scope": "WPEFramework::Plugin::WebSockets::MTlsEnabled", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"17552": "bc95ad096bdaa0d2d554ecfc4389c78048005d56"}]}