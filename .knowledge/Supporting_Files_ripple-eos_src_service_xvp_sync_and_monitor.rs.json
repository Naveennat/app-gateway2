{"is_source_file": true, "format": "Rust", "description": "This file defines the core service for synchronizing and monitoring state, privacy settings, and partner exclusions within a distributed SDK system. It includes the main SyncAndMonitorService class, handling asynchronous processing of state requests, subscription management, and periodic sync tasks.", "external_files": ["crate::manager::data_governor::DataGovernance", "crate::manager::privacy_response_manager::PrivacyResponseManager", "crate::message::DpabError", "crate::state::distributor_state::DistributorState", "crate::util::cloud_linchpin_monitor::LinchpinConnectionStatus", "crate::util::cloud_sync_monitor_utils::get_sync_settings", "crate::util::{cloud_linchpin_monitor::CloudLinchpinMonitor, cloud_periodic_sync::CloudPeriodicSync, cloud_sync_monitor_utils::StateRequest, sync_settings::SyncSettings}", "thunder_ripple_sdk::ripple_sdk::api::device::device_info_request::DeviceInfoRequest", "thunder_ripple_sdk::ripple_sdk::api::distributor::distributor_privacy::PrivacyResponse", "thunder_ripple_sdk::ripple_sdk::api::manifest::device_manifest::PrivacySettingsStorageType", "thunder_ripple_sdk::ripple_sdk::api::session::AccountSession", "std::collections::{HashMap, HashSet}", "std::sync::{Arc, Once, RwLock}", "std::time::Duration", "thunder_ripple_sdk::ripple_sdk::extn::client::extn_client::ExtnClient", "thunder_ripple_sdk::ripple_sdk::log::{debug, error}", "tokio::sync::mpsc::{self, Receiver, Sender}"], "external_methods": ["PrivacyResponseManager::start", "get_sync_settings", "DataGovernance::refresh_partner_exclusions"], "published": ["SyncAndMonitorModule", "SyncAndMonitorService"], "classes": [{"name": "SyncAndMonitorModule", "description": "Enumeration representing the modules that can be synchronized and monitored, such as Privacy and UserGrants."}, {"name": "SyncAndMonitorService", "description": "Main service class responsible for handling state requests, starting synchronization processes, and managing subscriptions related to privacy and user grants."}], "methods": [{"name": "process_state_requests( extn_client: ExtnClient, mut rx: Receiver<StateRequest>, account_session: Arc<RwLock<Option<AccountSession>>>, )", "description": "Asynchronous loop processing incoming state management requests such as adding/removing listeners, fetching listeners, and updating connection status.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "start(state: DistributorState)", "description": "Initializes and starts the SyncAndMonitorService with the provided DistributorState.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "new(state: &DistributorState) -> Self", "description": "Constructs a new instance of SyncAndMonitorService, setting up channels, monitoring, and synchronization tasks.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "sync(&self)", "description": "Triggers the synchronization process if privacy settings storage type is set to 'Sync'.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "handle_sync_request( &self, module: SyncAndMonitorModule, callback: Option<Sender<PrivacyResponse>>, ) -> Result<(), DpabError>", "description": "Handles synchronization requests for specific modules, manages subscriptions, and initiates periodic syncs.", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"name": "sync_partner_exclusions(state: DistributorState)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["Self::process_state_requests", "CloudPeriodicSync::start", "CloudLinchpinMonitor::start", "SyncAndMonitorService::handle_sync_request", "DataGovernance::refresh_partner_exclusions"], "search-terms": ["xvp_sync_and_monitor", "SyncAndMonitorService", "privacy_settings_storage_type", "partner_exclusion_refresh_timeout", "process_state_requests", "sync_partner_exclusions"], "state": 2, "file_id": 342, "knowledge_revision": 1063, "git_revision": "046761b9656aa3448e0e16f1a3a9c084965a6b28", "ctags": [{"_type": "tag", "name": "Privacy", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    Privacy,$/", "language": "Rust", "kind": "enumerator", "scope": "SyncAndMonitorModule", "scopeKind": "enum"}, {"_type": "tag", "name": "START_PARTNER_EXCLUSION_SYNC_THREAD", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^static START_PARTNER_EXCLUSION_SYNC_THREAD: Once = Once::new();$/", "language": "Rust", "kind": "variable"}, {"_type": "tag", "name": "SyncAndMonitorModule", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^pub enum SyncAndMonitorModule {$/", "language": "Rust", "kind": "enum"}, {"_type": "tag", "name": "SyncAndMonitorService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^impl SyncAndMonitorService {$/", "language": "Rust", "kind": "implementation"}, {"_type": "tag", "name": "SyncAndMonitorService", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^pub struct SyncAndMonitorService {$/", "language": "Rust", "kind": "struct"}, {"_type": "tag", "name": "UserGrants", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    UserGrants,$/", "language": "Rust", "kind": "enumerator", "scope": "SyncAndMonitorModule", "scopeKind": "enum"}, {"_type": "tag", "name": "cloud_linchpin_monitor", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    cloud_linchpin_monitor: CloudLinchpinMonitor,$/", "language": "Rust", "kind": "field", "scope": "SyncAndMonitorService", "scopeKind": "struct"}, {"_type": "tag", "name": "cloud_periodic_sync", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    pub cloud_periodic_sync: CloudPeriodicSync,$/", "language": "Rust", "kind": "field", "scope": "SyncAndMonitorService", "scopeKind": "struct"}, {"_type": "tag", "name": "handle_sync_request", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    async fn handle_sync_request($/", "language": "Rust", "kind": "method", "signature": "( &self, module: SyncAndMonitorModule, callback: Option<Sender<PrivacyResponse>>, ) -> Result<(), DpabError>", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "new", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    fn new(state: &DistributorState) -> Self {$/", "language": "Rust", "kind": "method", "signature": "(state: &DistributorState) -> Self", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "process_state_requests", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    pub async fn process_state_requests($/", "language": "Rust", "kind": "method", "signature": "( extn_client: ExtnClient, mut rx: Receiver<StateRequest>, account_session: Arc<RwLock<Option<AccountSession>>>, )", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    pub fn start(state: DistributorState) {$/", "language": "Rust", "kind": "method", "signature": "(state: DistributorState)", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    state: DistributorState,$/", "language": "Rust", "kind": "field", "scope": "SyncAndMonitorService", "scopeKind": "struct"}, {"_type": "tag", "name": "sync", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^    fn sync(&self) {$/", "language": "Rust", "kind": "method", "signature": "(&self)", "scope": "SyncAndMonitorService", "scopeKind": "implementation"}, {"_type": "tag", "name": "sync_partner_exclusions", "path": "/home/kavia/workspace/code-generation/app-gateway2/Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "pattern": "/^async fn sync_partner_exclusions(state: DistributorState) {$/", "language": "Rust", "kind": "function", "signature": "(state: DistributorState)"}], "hash": "fae0055f2fdfcf0c563921745723b688", "format-version": 4, "code-base-name": "app-gateway2", "filename": "Supporting_Files/ripple-eos/src/service/xvp_sync_and_monitor.rs", "fields": [{"name": "static START_PARTNER_EXCLUSION_SYNC_THREAD: Once = Once::new();", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cloud_linchpin_monitor: CloudLinchpinMonitor,", "scope": "SyncAndMonitorService", "scopeKind": "struct", "description": "unavailable"}, {"name": "pub cloud_periodic_sync: CloudPeriodicSync,", "scope": "SyncAndMonitorService", "scopeKind": "struct", "description": "unavailable"}, {"name": "state: DistributorState,", "scope": "SyncAndMonitorService", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"1063": "046761b9656aa3448e0e16f1a3a9c084965a6b28"}]}