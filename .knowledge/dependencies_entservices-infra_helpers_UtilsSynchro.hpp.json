{"is_source_file": true, "format": "C++ header (hpp)", "description": "This file contains utility templates and functions for thread-safe locking, registration of API methods with locking semantics, and synchronization mechanisms within the Utils::Synchro namespace. It defines templates for managing mutex locks per class, function wrappers to acquire locks around method calls, and guard structures to control lock states, primarily used for synchronizing access to shared resources in a multi-threaded environment.", "external_files": ["<mutex>", "<plugins/plugins.h>", "<memory>", "UtilsLogging.h"], "external_methods": [], "published": [], "classes": [{"name": "ApiLocks", "description": "A template struct that manages a static recursive_mutex for each class type, used to synchronize API calls for instances of that class."}, {"name": "UnlockApiGuard", "description": "A guard object that temporarily unlocks an API mutex if it is already locked by the thread, and re-locks upon destruction, to prevent deadlock during nested plugin invocations."}, {"name": "LockApiGuard", "description": "A guard object that manages a recursive_lock on the class's API mutex, providing explicit lock and unlock methods for control over critical sections."}], "methods": [{"name": "std::function<uint32_t (REALOBJECT *,const WPEFramework::Core::JSON::VariantContainer &,WPEFramework::Core::JSON::VariantContainer &)> getFunctionToCall(const std::string & debugname,const METHOD & method,REALOBJECT * objectPtr)", "description": "Creates a std::function wrapper that locks a recursive mutex, calls a specific method on an object, and manages thread-local state indicating lock usage.", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"name": "void RegisterLockedApi(const string & methodName,const METHOD & method,REALOBJECT * objectPtr)", "description": "Registers a method with the plugin framework, wrapping it with locking semantics for thread safety.", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"name": "void RegisterLockedApiForVersions(const string & methodName,const METHOD & method,REALOBJECT * objectPtr,const std::vector<uint8_t> versions)", "description": "Registers a method with version control, with locking behavior.", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"name": "void RegisterLockedApiForHandler(Core::JSONRPC::Handler * handler,const string & methodName,const METHOD & method,REALOBJECT * objectPtr)", "description": "Registers a method with a JSONRPC handler, providing thread-safe access.", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"name": "LockApiGuard()", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct", "description": "unavailable"}, {"name": "UnlockApiGuard()", "scope": "Utils::Synchro::UnlockApiGuard", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t __anon924e0a050202(REALOBJECT *obj, const WPEFramework::Core::JSON::VariantContainer& in, WPEFramework::Core::JSON::VariantContainer& out)", "scope": "Utils::Synchro::getFunctionToCall", "scopeKind": "function", "description": "unavailable"}, {"name": "void lock()", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct", "description": "unavailable"}, {"name": "void unlock()", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct", "description": "unavailable"}, {"name": "~UnlockApiGuard()", "scope": "Utils::Synchro::UnlockApiGuard", "scopeKind": "struct", "description": "unavailable"}], "calls": ["getFunctionToCall", "obj->PluginHost::JSONRPC::Register"], "search-terms": ["UtilsSynchro", "ApiLocks", "getFunctionToCall", "RegisterLockedApi", "UnlockApiGuard", "LockApiGuard", "thread_local", "jsonrpc", "mutex"], "state": 2, "file_id": 8521, "knowledge_revision": 17257, "git_revision": "", "ctags": [{"_type": "tag", "name": "ApiLocks", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        struct ApiLocks {$/", "language": "C++", "kind": "struct", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "LockApiGuard", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            LockApiGuard() : _lock(ApiLocks<UsingClass>::mtx) {}$/", "language": "C++", "kind": "function", "signature": "()", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct"}, {"_type": "tag", "name": "LockApiGuard", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        struct LockApiGuard {$/", "language": "C++", "kind": "struct", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "MethodType", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            using MethodType = decltype(getFunctionToCall(methodName, method, objectPtr));$/", "language": "C++", "kind": "typedef", "scope": "Utils::Synchro::RegisterLockedApi", "scopeKind": "function"}, {"_type": "tag", "name": "RegisterLockedApi", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        void RegisterLockedApi(const string& methodName, const METHOD& method, REALOBJECT* objec/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const string & methodName,const METHOD & method,REALOBJECT * objectPtr)", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "RegisterLockedApiForHandler", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        void RegisterLockedApiForHandler(Core::JSONRPC::Handler* handler, const string& methodNa/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(Core::JSONRPC::Handler * handler,const string & methodName,const METHOD & method,REALOBJECT * objectPtr)", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "RegisterLockedApiForVersions", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        void RegisterLockedApiForVersions(const string& methodName, const METHOD& method, REALOB/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "(const string & methodName,const METHOD & method,REALOBJECT * objectPtr,const std::vector<uint8_t> versions)", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "Synchro", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^    namespace Synchro {$/", "language": "C++", "kind": "namespace", "scope": "Utils", "scopeKind": "namespace"}, {"_type": "tag", "name": "UnlockApiGuard", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            UnlockApiGuard() {$/", "language": "C++", "kind": "function", "signature": "()", "scope": "Utils::Synchro::UnlockApiGuard", "scopeKind": "struct"}, {"_type": "tag", "name": "UnlockApiGuard", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        struct UnlockApiGuard {$/", "language": "C++", "kind": "struct", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "Utils", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^namespace Utils {$/", "language": "C++", "kind": "namespace"}, {"_type": "tag", "name": "__anon924e0a050111", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        namespace {$/", "language": "C++", "kind": "namespace", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "__anon924e0a050202", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            return [debugname, method](REALOBJECT *obj, const WPEFramework::Core::JSON::VariantC/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "function", "signature": "(REALOBJECT *obj, const WPEFramework::Core::JSON::VariantContainer& in, WPEFramework::Core::JSON::VariantContainer& out) ", "scope": "Utils::Synchro::getFunctionToCall", "scopeKind": "function"}, {"_type": "tag", "name": "_lock", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            std::unique_lock<std::recursive_mutex> _lock;$/", "language": "C++", "typeref": "typename:std::unique_lock<std::recursive_mutex>", "kind": "member", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct"}, {"_type": "tag", "name": "getFunctionToCall", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        getFunctionToCall(const std::string& debugname, const METHOD& method, REALOBJECT* object/", "language": "C++", "typeref": "typename:std::function<uint32_t (REALOBJECT *,const WPEFramework::Core::JSON::VariantContainer &,WPEFramework::Core::JSON::VariantContainer &)>", "kind": "function", "signature": "(const std::string & debugname,const METHOD & method,REALOBJECT * objectPtr)", "scope": "Utils::Synchro", "scopeKind": "namespace"}, {"_type": "tag", "name": "isThreadUsingLockedApi", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            thread_local bool isThreadUsingLockedApi = false;$/", "language": "C++", "typeref": "typename:thread_local bool", "kind": "variable", "scope": "Utils::Synchro::__anon924e0a050111", "scopeKind": "namespace"}, {"_type": "tag", "name": "lock", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            void lock() {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct"}, {"_type": "tag", "name": "mtx", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            static std::recursive_mutex mtx;$/", "language": "C++", "typeref": "typename:std::recursive_mutex", "kind": "member", "scope": "Utils::Synchro::ApiLocks", "scopeKind": "struct"}, {"_type": "tag", "name": "mtx", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^        template <class C> std::recursive_mutex ApiLocks<C>::mtx;$/", "language": "C++", "typeref": "typename:std::recursive_mutex", "kind": "member", "scope": "Utils::Synchro::ApiLocks<C>", "scopeKind": "class"}, {"_type": "tag", "name": "unlock", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            void unlock() {$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct"}, {"_type": "tag", "name": "~UnlockApiGuard", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "pattern": "/^            ~UnlockApiGuard() {$/", "language": "C++", "kind": "function", "signature": "()", "scope": "Utils::Synchro::UnlockApiGuard", "scopeKind": "struct"}], "hash": "771d7a4a9a61d8ebc95904f31609e6a6", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/entservices-infra/helpers/UtilsSynchro.hpp", "fields": [{"name": "std::unique_lock<std::recursive_mutex> _lock", "scope": "Utils::Synchro::LockApiGuard", "scopeKind": "struct", "description": "unavailable"}, {"name": "thread_local bool isThreadUsingLockedApi", "scope": "Utils::Synchro::__anon924e0a050111", "scopeKind": "namespace", "description": "unavailable"}, {"name": "std::recursive_mutex mtx", "scope": "Utils::Synchro::ApiLocks", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"17257": ""}]}