{"is_source_file": true, "format": "C++", "description": "This file implements a TCP socket server in C++ that manages client connections, handles communication protocols including different message headers and command IDs, and provides methods to send and receive data over sockets. It encapsulates socket operations such as opening a socket, binding, listening, accepting clients, reading exact byte sequences, and sending various message types such as invoke requests, attach commands, and exit signals.", "external_files": ["SocketServer.h", "Logger.h", "<sys/socket.h>", "<sys/time.h>", "<netinet/ip.h>", "<arpa/inet.h>", "<string.h>", "<unistd.h>", "<fcntl.h>"], "external_methods": ["socket", "bind", "listen", "accept", "close", "read", "send", "fcntl", "inet_pton", "getsockname", "strerror", "malloc", "free"], "published": ["SocketServer::Open", "SocketServer::RunThread", "SocketServer::GetAddress", "SocketServer::GetPort", "SocketServer::Close", "SocketServer::SendInvoke", "SocketServer::SendAttach", "SocketServer::SendExit", "SocketServer::ReadResponse"], "classes": [{"name": "Response", "description": "Represents a response message received from the socket connection, including the channel ID and JSON payload."}, {"name": "SocketServer", "description": "Implements a TCP server that accepts client connections, manages communication protocols, and provides methods to send and receive structured messages."}], "methods": [{"name": "Response()", "description": "Default constructor initializing channel ID to zero and an empty JSON string.", "scope": "Response", "scopeKind": "class"}, {"name": "Response(uint32_t channel, const string& json_str)", "description": "Constructor that sets the channel ID and JSON payload."}, {"name": "SocketServer()", "description": "Constructor initializing member variables.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "~SocketServer()", "description": "Destructor that closes the socket connection if open.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int Open(const string & address,int port,const function<void (const Response &)> & reader)", "description": "Sets up the server socket, binds it to the specified address and port, and starts listening for incoming connections.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int RunThread()", "description": "Creates a thread to run the server loop.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "void * RunThreadFunc(void * arg)", "description": "Static function used by the thread to run the server loop.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int Run()", "description": "Main server loop processing incoming connections and data.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "string GetAddress() const", "description": "Returns the server's bound address.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int GetPort() const", "description": "Returns the server's port.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "void Close()", "description": "Closes the server and client sockets.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int ReadExact(uint8_t * p,int len)", "description": "Reads an exact number of bytes from the client socket, handling partial reads.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int SendInvoke(uint32_t channel_id,const string & token,const string & json)", "description": "Sends an invoke command with command ID, token, and JSON payload.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int SendAttach(uint32_t channel_id,bool attach)", "description": "Sends an attach command with specified channel ID and attach flag.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int SendExit()", "description": "Sends an exit command to terminate the client connection.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int ReadResponse(Response & rsp)", "description": "Reads a response header and payload from the socket, populating a Response object.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "Response(uint32_t channel,const string & json_str)", "scope": "Response", "scopeKind": "class", "description": "unavailable"}], "calls": ["socket", "bind", "listen", "accept", "close", "read", "send", "fcntl", "inet_pton", "getsockname", "strerror", "malloc", "free"], "search-terms": ["SocketServer", "Open", "SendInvoke", "SendAttach", "SendExit", "ReadResponse", "client connection", "headers", "CommandID", "ResponseHeader"], "state": 2, "file_id": 4291, "knowledge_revision": 8553, "git_revision": "", "ctags": [{"_type": "tag", "name": "AttachHeader", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^struct AttachHeader$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "CLIENT_DISCONNECT", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^#define CLIENT_DISCONNECT /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "Close", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^void SocketServer::Close()$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "CommandID", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^enum CommandID$/", "file": true, "language": "C++", "kind": "enum"}, {"_type": "tag", "name": "GetAddress", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^string SocketServer::GetAddress() const$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "GetPort", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::GetPort() const$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "() const", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "ID_ATTACH", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  ID_ATTACH,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "CommandID", "scopeKind": "enum"}, {"_type": "tag", "name": "ID_EXIT", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  ID_EXIT$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "CommandID", "scopeKind": "enum"}, {"_type": "tag", "name": "ID_INVOKE", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  ID_INVOKE = 1,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "CommandID", "scopeKind": "enum"}, {"_type": "tag", "name": "InvoketHeader", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^struct InvoketHeader$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "Open", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::Open(const string& address, int port, const function<void (const Response&)>& /", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(const string & address,int port,const function<void (const Response &)> & reader)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "ReadExact", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::ReadExact(uint8_t* p, int len)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(uint8_t * p,int len)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "ReadResponse", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::ReadResponse(Response& rsp)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(Response & rsp)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "Response", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^Response::Response()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "Response", "scopeKind": "class"}, {"_type": "tag", "name": "Response", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^Response::Response(uint32_t channel, const string& json_str)$/", "language": "C++", "kind": "function", "signature": "(uint32_t channel,const string & json_str)", "scope": "Response", "scopeKind": "class"}, {"_type": "tag", "name": "ResponseHeader", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^struct ResponseHeader$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "Run", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::Run()$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "RunThread", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::RunThread()$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "RunThreadFunc", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^void* SocketServer::RunThreadFunc(void* arg)$/", "language": "C++", "typeref": "typename:void *", "kind": "function", "signature": "(void * arg)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SendAttach", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::SendAttach(uint32_t channel_id, bool attach)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(uint32_t channel_id,bool attach)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SendExit", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::SendExit()$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SendInvoke", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::SendInvoke(uint32_t channel_id, const string& token, const string& json)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(uint32_t channel_id,const string & token,const string & json)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SocketServer", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^SocketServer::SocketServer()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "attach", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint8_t attach;$/", "file": true, "language": "C++", "typeref": "typename:uint8_t", "kind": "member", "scope": "AttachHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "channel_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t channel_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "AttachHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "channel_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t channel_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "channel_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t channel_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "ResponseHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "command_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t command_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "AttachHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "command_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t command_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "json_len", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t json_len;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "json_len", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t json_len;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "ResponseHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "token_len", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t token_len;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "~SocketServer", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^SocketServer::~SocketServer()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}], "hash": "28000ea232639c13c36001317fbde1dd", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "fields": [{"name": "uint8_t attach", "scope": "AttachHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t channel_id", "scope": "AttachHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t command_id", "scope": "AttachHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t json_len", "scope": "InvoketHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t token_len", "scope": "InvoketHeader", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"8553": ""}]}