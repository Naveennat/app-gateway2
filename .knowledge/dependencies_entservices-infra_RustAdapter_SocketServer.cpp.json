{"is_source_file": true, "format": "C++", "description": "This file implements a TCP socket server for handling command and response communication, including socket setup, accept loops, reading/writing messages with custom headers, and threading control.", "external_files": ["SocketServer.h", "Logger.h", "<sys/socket.h>", "<sys/time.h>", "<netinet/ip.h>", "<arpa/inet.h>", "<string.h>", "<unistd.h>", "<fcntl.h>"], "external_methods": ["socket()", "connect()", "bind()", "listen()", "accept()", "select()", "read()", "write()", "close()", "inet_pton()", "fcntl()", "htons()", "ntohl()", "malloc()", "free()"], "published": ["SocketServer::Open", "SocketServer::RunThread", "SocketServer::Close", "SocketServer::SendInvoke", "SocketServer::SendAttach", "SocketServer::SendExit"], "classes": [{"name": "Response", "description": "Represents a response message with a channel ID and JSON payload."}, {"name": "SocketServer", "description": "Implements a TCP socket server for communication with clients, including connection management, message reading/writing, and threading."}], "methods": [{"name": "Response()", "description": "Default constructor initializing channel ID to zero and JSON string empty.", "scope": "Response", "scopeKind": "class"}, {"name": "Response(uint32_t channel, const string& json_str)", "description": "Constructor initializing with specific channel ID and JSON payload."}, {"name": "SocketServer()", "description": "Constructor initializing socket server state.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "~SocketServer()", "description": "Destructor closing socket connections.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int Open(const string& address, int port, const function<void (const Response&)>& reader)", "description": "Sets up the server socket, binds to address and port, starts listening, and registers a callback for incoming responses."}, {"name": "int RunThread()", "description": "Creates and starts the server thread to handle incoming connections and messages.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "void* RunThreadFunc(void* arg)", "description": "Thread entry function that runs the server loop."}, {"name": "int Run()", "description": "Main server loop: accepts new clients, reads data, and calls the response handler.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "string GetAddress() const", "description": "Returns the server's configured address.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int GetPort() const", "description": "Returns the server's port.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "void Close()", "description": "Stops the server and closes all sockets.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int ReadExact(uint8_t* p, int len)", "description": "Reads exactly 'len' bytes from the client socket into buffer 'p'."}, {"name": "int SendInvoke(uint32_t channel_id, const string& token, const string& json)", "description": "Sends an invoke command with headers and payload to the client."}, {"name": "int SendAttach(uint32_t channel_id, bool attach)", "description": "Sends an attach or detach command."}, {"name": "int SendExit()", "description": "Sends an exit command to disconnect the client.", "scope": "SocketServer", "scopeKind": "class"}, {"name": "int ReadResponse(Response& rsp)", "description": "Reads a response header and payload from the client socket."}, {"name": "int Open(const string & address,int port,const function<void (const Response &)> & reader)", "scope": "SocketServer", "scopeKind": "class", "description": "unavailable"}, {"name": "int ReadExact(uint8_t * p,int len)", "scope": "SocketServer", "scopeKind": "class", "description": "unavailable"}, {"name": "int ReadResponse(Response & rsp)", "scope": "SocketServer", "scopeKind": "class", "description": "unavailable"}, {"name": "Response(uint32_t channel,const string & json_str)", "scope": "Response", "scopeKind": "class", "description": "unavailable"}, {"name": "void * RunThreadFunc(void * arg)", "scope": "SocketServer", "scopeKind": "class", "description": "unavailable"}, {"name": "int SendAttach(uint32_t channel_id,bool attach)", "scope": "SocketServer", "scopeKind": "class", "description": "unavailable"}, {"name": "int SendInvoke(uint32_t channel_id,const string & token,const string & json)", "scope": "SocketServer", "scopeKind": "class", "description": "unavailable"}], "calls": ["socket()", "accept()", "select()", "read()", "write()", "close()", "inet_pton()", "fcntl()", "htons()", "ntohl()", "malloc()", "free()", "strerror()", "pthread_create()"], "search-terms": ["SocketServer", "ResponseHeader", "CommandID", "SendInvoke", "SendAttach", "SendExit", "SocketServer::Run", "ReadResponse", "client disconnected"], "state": 2, "file_id": 4354, "knowledge_revision": 8972, "git_revision": "", "ctags": [{"_type": "tag", "name": "AttachHeader", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^struct AttachHeader$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "CLIENT_DISCONNECT", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^#define CLIENT_DISCONNECT /", "file": true, "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "Close", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^void SocketServer::Close()$/", "language": "C++", "typeref": "typename:void", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "CommandID", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^enum CommandID$/", "file": true, "language": "C++", "kind": "enum"}, {"_type": "tag", "name": "GetAddress", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^string SocketServer::GetAddress() const$/", "language": "C++", "typeref": "typename:string", "kind": "function", "signature": "() const", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "GetPort", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::GetPort() const$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "() const", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "ID_ATTACH", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  ID_ATTACH,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "CommandID", "scopeKind": "enum"}, {"_type": "tag", "name": "ID_EXIT", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  ID_EXIT$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "CommandID", "scopeKind": "enum"}, {"_type": "tag", "name": "ID_INVOKE", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  ID_INVOKE = 1,$/", "file": true, "language": "C++", "kind": "enumerator", "scope": "CommandID", "scopeKind": "enum"}, {"_type": "tag", "name": "InvoketHeader", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^struct InvoketHeader$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "Open", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::Open(const string& address, int port, const function<void (const Response&)>& /", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(const string & address,int port,const function<void (const Response &)> & reader)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "ReadExact", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::ReadExact(uint8_t* p, int len)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(uint8_t * p,int len)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "ReadResponse", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::ReadResponse(Response& rsp)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(Response & rsp)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "Response", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^Response::Response()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "Response", "scopeKind": "class"}, {"_type": "tag", "name": "Response", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^Response::Response(uint32_t channel, const string& json_str)$/", "language": "C++", "kind": "function", "signature": "(uint32_t channel,const string & json_str)", "scope": "Response", "scopeKind": "class"}, {"_type": "tag", "name": "ResponseHeader", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^struct ResponseHeader$/", "file": true, "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "Run", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::Run()$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "RunThread", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::RunThread()$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "RunThreadFunc", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^void* SocketServer::RunThreadFunc(void* arg)$/", "language": "C++", "typeref": "typename:void *", "kind": "function", "signature": "(void * arg)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SendAttach", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::SendAttach(uint32_t channel_id, bool attach)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(uint32_t channel_id,bool attach)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SendExit", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::SendExit()$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SendInvoke", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^int SocketServer::SendInvoke(uint32_t channel_id, const string& token, const string& json)$/", "language": "C++", "typeref": "typename:int", "kind": "function", "signature": "(uint32_t channel_id,const string & token,const string & json)", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "SocketServer", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^SocketServer::SocketServer()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}, {"_type": "tag", "name": "attach", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint8_t attach;$/", "file": true, "language": "C++", "typeref": "typename:uint8_t", "kind": "member", "scope": "AttachHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "channel_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t channel_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "AttachHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "channel_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t channel_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "channel_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t channel_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "ResponseHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "command_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t command_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "AttachHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "command_id", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t command_id;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "json_len", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t json_len;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "json_len", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t json_len;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "ResponseHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "token_len", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^  uint32_t token_len;$/", "file": true, "language": "C++", "typeref": "typename:uint32_t", "kind": "member", "scope": "InvoketHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "~SocketServer", "path": "/home/kavia/workspace/code-generation/app-gateway2/dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "pattern": "/^SocketServer::~SocketServer()$/", "language": "C++", "kind": "function", "signature": "()", "scope": "SocketServer", "scopeKind": "class"}], "hash": "28000ea232639c13c36001317fbde1dd", "format-version": 4, "code-base-name": "app-gateway2", "filename": "dependencies/entservices-infra/RustAdapter/SocketServer.cpp", "fields": [{"name": "uint8_t attach", "scope": "AttachHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t channel_id", "scope": "AttachHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t command_id", "scope": "AttachHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t json_len", "scope": "InvoketHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint32_t token_len", "scope": "InvoketHeader", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"8972": ""}]}